(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"suC+":function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n("fXoL"),i=n("e8h1"),o=n("D0XW"),s=n("HDdC"),u=n("Cfvw"),a=n("LRne"),c=n("lJxs"),h=n("Kqap"),f=n("pLZG"),l=n("pxpQ"),p=n("spgP"),d=n("ofXK"),v=(n("xsWp"),n("Jgta"));function y(t,e){return function(t,e=o.a){return new s.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot(n)}):r=t.onSnapshot(n),()=>{null!=r&&r()}})}(t,e)}function g(t,e){return y(t,e).pipe(Object(c.a)(t=>({payload:t,type:"query"})))}function b(t,e){return g(t,e).pipe(Object(c.a)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function m(t,e,n){return g(t,n).pipe(Object(c.a)(t=>t.payload.docChanges()),Object(h.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),Object(c.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function w(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class _{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?b(this.query,this.afs.schedulers.outsideAngular).pipe(Object(c.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(f.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):b(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(h.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=w(t);return m(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return g(this.query,this.afs.schedulers.outsideAngular).pipe(Object(c.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(u.a)(this.query.get(t)).pipe(Object(l.a)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new I(this.ref.doc(t),this.afs)}}class I{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=x(n,e);return new _(r,i,this.afs)}snapshotChanges(){return y(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(c.a)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return this.snapshotChanges().pipe(Object(c.a)(t=>t.payload.data()))}get(t){return Object(u.a)(this.ref.get(t)).pipe(Object(l.a)(this.afs.schedulers.insideAngular))}}class E{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?b(this.query,this.afs.schedulers.outsideAngular).pipe(Object(c.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(f.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):b(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(h.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=w(t);return m(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return g(this.query,this.afs.schedulers.outsideAngular).pipe(Object(c.a)(t=>t.payload.docs.map(t=>t.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(u.a)(this.query.get(t)).pipe(Object(l.a)(this.afs.schedulers.insideAngular))}}const O=n("xsWp"),T=new r.q("angularfire2.enableFirestorePersistence"),j=new r.q("angularfire2.firestore.persistenceSettings"),N=new r.q("angularfire2.firestore.settings");function x(t,e=(t=>t)){return{query:e(t),ref:t}}let A=(()=>{class t{constructor(t,e,n,r,i,o,s){this.schedulers=new p.d(o),this.keepUnstableUntilFirst=Object(p.f)(this.schedulers),this.firestore=o.runOutsideAngular(()=>{const n=Object(p.e)(t,o,e);"registerFirestore"in O&&O.registerFirestore(v.a);const i=n.firestore();return r&&i.settings(r),i}),this.persistenceEnabled$=n&&!Object(d.m)(i)?o.runOutsideAngular(()=>{try{return Object(u.a)(this.firestore.enablePersistence(s||void 0).then(()=>!0,()=>!1))}catch(t){return Object(a.a)(!1)}}):Object(a.a)(!1)}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=x(n,e),o=this.schedulers.ngZone.run(()=>r);return new _(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new E(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new I(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(r.Sb(p.c),r.Sb(p.b,8),r.Sb(T,8),r.Sb(N,8),r.Sb(r.B),r.Sb(r.z),r.Sb(j,8))},t.\u0275prov=Object(r.Fb)({factory:function(){return new t(Object(r.Sb)(p.c),Object(r.Sb)(p.b,8),Object(r.Sb)(T,8),Object(r.Sb)(N,8),Object(r.Sb)(r.B),Object(r.Sb)(r.z),Object(r.Sb)(j,8))},token:t,providedIn:"any"}),t})(),S=(()=>{class t{constructor(t,e){this.storage=t,this.firestore=e,this.msg="",this.tag="",this.dbVersion=0,this.questionIndices=new Map,this.dbName="Not created yet",this.score=0,this.nbRightAnswer=0,this.nbQuestionQuiz=0,this.songs=[]}update_db(){return navigator.onLine?this.get_firestore_version().then(t=>this.get_local_db_version().then(e=>e!=t?(console.log("Local DB needs to be updated"),this.dbVersion=t,this.delete_local_db().then(()=>this.initialize_db().then(()=>this.fill_db().then(t=>(console.log("FILLED",t),this.save_indices().then(t=>(console.log("INDICES",t),!0))))))):(console.log("Local DB is up to date"),this.retrieve_indices().then(()=>!0)))):this.get_local_db_version().then(t=>t>0?(console.log("No connection, but local DB exists"),this.retrieve_indices().then(()=>!0)):(console.log("No connection and no local DB, please connect"),!1))}get_firestore_version(){return this.firestore.collection("meta_info").doc("version").get().toPromise().then(t=>t.data().number)}get_local_db_version(){return this.storage.get("version").then(t=>Number(t))}initialize_db(){return this.storage.ready().then(()=>{this.dbName=this.storage.driver,this.storage.set("version",this.dbVersion.toString())})}fill_db(){return this.firestore.collection("songs").get().toPromise().then(t=>{let e=1;return this.questionIndices.set("english",[]),this.questionIndices.set("french",[]),t.forEach(t=>{if("version_doc"!=t.id&&"english"!=t.id&&"french"!=t.id){let n=t.data();"fr"==n.src_lang?this.questionIndices.get("french").push(e):this.questionIndices.get("english").push(e),n.hasOwnProperty("genre_tag")&&(this.questionIndices.has(n.genre_tag)?this.questionIndices.get(n.genre_tag).push(e):this.questionIndices.set(n.genre_tag,[])),n.hasOwnProperty("artist_tag")&&(this.questionIndices.has(n.artist_tag)?this.questionIndices.get(n.artist_tag).push(e):this.questionIndices.set(n.artist_tag,[])),this.songs.push(n)}e++}),this.save_songs().then(()=>"ok songs")})}save_songs(){return this.storage.ready().then(()=>{let t=1;for(let e of this.songs)this.storage.set(t.toString(),JSON.stringify({artist:e.artist,title:e.title,lyrics:e.trans_lyrics})),t++})}save_indices(){return this.storage.ready().then(()=>(console.log("INDICES"),this.storage.set("questionIndices",JSON.stringify([...this.questionIndices])),"ok indices"))}retrieve_indices(){return this.storage.get("questionIndices").then(t=>{this.dbName=this.storage.driver,this.questionIndices=new Map(JSON.parse(t||"{}"))})}delete_local_db(){return this.storage.clear().then(()=>{})}get_questionIndices(){return this.questionIndices.get(this.tag)}get_lyrics(t){return this.storage.get(t).then(t=>JSON.parse(t||"{}").lyrics)}get_title(t){return this.storage.get(t).then(t=>{let e=JSON.parse(t||"{}");return e.title+" by "+e.artist})}}return t.\u0275fac=function(e){return new(e||t)(r.Sb(i.b),r.Sb(A))},t.\u0275prov=r.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},xsWp:function(t,e,n){"use strict";n.r(e),n.d(e,"__PRIVATE_registerFirestore",(function(){return zl}));var r=n("O1h7"),i=n("zIRd"),o=n("q/0M"),s=n("qOnz"),u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var c,h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f=f||{},l=h||self;function p(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function v(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function y(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),b=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:w).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function O(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++b)}(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},N=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function x(t){return Array.prototype.concat.apply([],arguments)}function A(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function S(t){return/^[\s\xa0]*$/.test(t)}var k,D=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function P(t,e){return-1!=t.indexOf(e)}function C(t,e){return t<e?-1:t>e?1:0}t:{var L=l.navigator;if(L){var V=L.userAgent;if(V){k=V;break t}}k=""}function R(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<U.length;o++)n=U[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function F(t){return F[" "](t),t}F[" "]=p;var B,G,z=P(k,"Opera"),K=P(k,"Trident")||P(k,"MSIE"),Q=P(k,"Edge"),H=Q||K,W=P(k,"Gecko")&&!(P(k.toLowerCase(),"webkit")&&!P(k,"Edge"))&&!(P(k,"Trident")||P(k,"MSIE"))&&!P(k,"Edge"),Y=P(k.toLowerCase(),"webkit")&&!P(k,"Edge");function X(){var t=l.document;return t?t.documentMode:void 0}t:{var J="",$=(G=k,W?/rv:([^\);]+)(\)|;)/.exec(G):Q?/Edge\/([\d\.]+)/.exec(G):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(G):Y?/WebKit\/(\S+)/.exec(G):z?/(?:Version)[ \/]?(\S+)/.exec(G):void 0);if($&&(J=$?$[1]:""),K){var Z=X();if(null!=Z&&Z>parseFloat(J)){B=String(Z);break t}}B=J}var tt={};function et(t){return function(t,e){var n=tt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=D(String(B)).split("."),r=D(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=C(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||C(0==s[2].length,0==u[2].length)||C(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}var nt=l.document&&K&&(X()||parseInt(B,10))||void 0,rt=!K||9<=Number(nt),it=K&&!et("9"),ot=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{l.addEventListener("test",p,e),l.removeEventListener("test",p,e)}catch(n){}return t}();function st(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ut(t,e){if(st.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(W){t:{try{F(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:at[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}st.prototype.b=function(){this.defaultPrevented=!0},O(ut,st);var at={2:"touch",3:"pen",4:"mouse"};ut.prototype.b=function(){ut.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,it)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(sr){}};var ct="closure_listenable_"+(1e6*Math.random()|0),ht=0;function ft(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ht,this.Y=this.Z=!1}function lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function pt(t){this.src=t,this.a={},this.b=0}function dt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=j(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}pt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=vt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ft(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var yt="closure_lm_"+(1e6*Math.random()|0),gt={};function bt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[ct]?e.wa(n,r,y(i)?!!i.capture:!!i,o):mt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[ct]?t.va(e,n,y(r)?!!r.capture:!!r,i):mt(t,e,n,!1,r,i)}function mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=y(i)?!!i.capture:!!i;if(s&&!rt)return null;var u=Ot(t);if(u||(t[yt]=u=new pt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Et,e=rt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ot||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function wt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ct])dt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ot(e))?(dt(n,t),0==n.b&&(n.src=null,e[yt]=null)):lt(t)}}}function _t(t){return t in gt?gt[t]:gt[t]="on"+t}function It(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&wt(t),n.call(r,e)}function Et(t,e){if(t.Y)return!0;if(!rt){if(!e)t:{e=["window","event"];for(var n=l,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return It(t,e=new ut(e,this))}return It(t,new ut(e,this))}function Ot(t){return(t=t[yt])instanceof pt?t:null}var Tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(t){return"function"==d(t)?t:(t[Tt]||(t[Tt]=function(e){return t.handleEvent(e)}),t[Tt])}function Nt(){T.call(this),this.c=new pt(this),this.J=this,this.C=null}function xt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&dt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}O(Nt,T),Nt.prototype[ct]=!0,(c=Nt.prototype).addEventListener=function(t,e,n,r){bt(this,t,e,n,r)},c.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=y(i)?!!i.capture:!!i,r=jt(r),e&&e[ct]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=vt(s=e.a[n],r,i,o))&&(lt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=Ot(e))&&(n=e.a[n.toString()],e=-1,n&&(e=vt(n,r,i,o)),(r=-1<e?n[e]:null)&&wt(r))}(this,t,e,n,r)},c.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new st(t,n);else if(t instanceof st)t.target=t.target||n;else{var i=t;q(t=new st(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=xt(s,r,!0,t)&&i}if(i=xt(s=t.a=n,r,!0,t)&&i,i=xt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=xt(s=t.a=e[o],r,!1,t)&&i;return i},c.G=function(){if(Nt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)lt(n[r]);delete e.a[t],e.b--}}this.C=null},c.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},c.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var At=l.JSON.stringify;function St(){this.b=this.a=null}var kt,Dt=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new Ct}),(function(t){t.reset()}),100);function Pt(){var t=Mt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ct(){this.next=this.b=this.a=null}function Lt(t){l.setTimeout((function(){throw t}),0)}function Vt(t,e){kt||function(){var t=l.Promise.resolve(void 0);kt=function(){t.then(Ut)}}(),Rt||(kt(),Rt=!0),Mt.add(t,e)}St.prototype.add=function(t,e){var n=Dt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ct.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ct.prototype.reset=function(){this.next=this.b=this.a=null};var Rt=!1,Mt=new St;function Ut(){for(var t;t=Pt();){try{t.a.call(t.b)}catch(n){Lt(n)}var e=Dt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Rt=!1}function qt(t,e){Nt.call(this),this.b=t||1,this.a=e||l,this.f=_(this.Ya,this),this.g=E()}function Ft(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Bt(t,e,n){if("function"==d(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:l.setTimeout(t,e||0)}function Gt(t){t.a=Bt((function(){t.a=null,t.c&&(t.c=!1,Gt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}O(qt,Nt),(c=qt.prototype).aa=!1,c.M=null,c.Ya=function(){if(this.aa){var t=E()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Ft(this),this.start()))}},c.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=E())},c.G=function(){qt.S.G.call(this),Ft(this),delete this.a};var zt=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Gt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(l.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function Kt(t){T.call(this),this.b=t,this.a={}}O(Kt,T);var Qt=[];function Ht(t,e,n,r){Array.isArray(n)||(n&&(Qt[0]=n.toString()),n=Qt);for(var i=0;i<n.length;i++){var o=bt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Wt(t){R(t.a,(function(t,e){this.a.hasOwnProperty(e)&&wt(t)}),t),t.a={}}function Yt(){this.a=!0}function Xt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return At(n)}catch(u){return e}}(t,n)+(r?" "+r:"")}))}Kt.prototype.G=function(){Kt.S.G.call(this),Wt(this)},Kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yt.prototype.info=function(){};var Jt=null;function $t(){return Jt=Jt||new Nt}function Zt(t){st.call(this,"serverreachability",t)}function te(t){var e=$t();e.dispatchEvent(new Zt(e,t))}function ee(t){st.call(this,"statevent",t)}function ne(t){var e=$t();e.dispatchEvent(new ee(e,t))}function re(t){st.call(this,"timingevent",t)}function ie(t,e){if("function"!=d(t))throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){t()}),e)}O(Zt,st),O(ee,st),O(re,st);var oe={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},se={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function ue(){}function ae(){}ue.prototype.a=null;var ce,he={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function fe(){st.call(this,"d")}function le(){st.call(this,"c")}function pe(){}function de(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new Kt(this),this.P=ve,this.R=new qt(t=H?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}O(fe,st),O(le,st),O(pe,ue),ce=new pe;var ve=45e3,ye={},ge={};function be(t,e,n){t.H=1,t.i=qe(Ce(e)),t.j=n,t.I=!0,me(t,null)}function me(t,e){t.u=E(),Ie(t),t.l=Ce(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),Ze(n.b,"t",r),t.D=0,t.a=Wn(t.g,t.g.C?e:null),0<t.O&&(t.F=new zt(_(t.Ca,t,t.a),t.O)),Ht(t.J,t.a,"readystatechange",t.Wa),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),te(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.T,t.j)}function we(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=_e(t,n);if(i==ge){4==e&&(t.h=4,ne(14),r=!1),Xt(t.c,t.f,null,"[Incomplete Response]");break}if(i==ye){t.h=4,ne(15),Xt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Xt(t.c,t.f,i,null),Ne(t,i)}4==e&&0==n.length&&(t.h=1,ne(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),qn(e),e.F=!0)):(Xt(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Te(t))}function _e(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ge:(n=Number(e.substring(n,r)),isNaN(n)?ye:(r+=1)+n>e.length?ge:(e=e.substr(r,n),t.D=r+n,e))}function Ie(t){t.U=E()+t.P,Ee(t,t.P)}function Ee(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ie(_(t.Ua,t),e)}function Oe(t){t.o&&(l.clearTimeout(t.o),t.o=null)}function Te(t){0==t.g.v||t.A||Gn(t.g,t)}function je(t){Oe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Ft(t.R),Wt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ne(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||un(n.b,t)))if(n.I=t.N,!t.C&&un(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(zl){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Bn(n),kn(n)}Un(n),ne(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ie(_(n.Ra,n),6e3));if(1>=sn(n.b)&&n.ea){try{n.ea()}catch(zl){}n.ea=void 0}}else Kn(n,11)}else if((t.C||n.a==t)&&Bn(n),!S(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(P(h,"spdy")||P(h,"quic")||P(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(an(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Ue(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=E()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Hn(a,a.C?a.ga:null,a.fa),p.C){cn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Oe(d),Ie(d)),a.a=p}else Mn(a);0<n.g.length&&Cn(n)}else"stop"!=i[0]&&"close"!=i[0]||Kn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Kn(n,7):Sn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);te(4)}catch(zl){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(v(t)||"string"==typeof t)N(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(v(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(v(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ae(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ae)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Se(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ke(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(c=de.prototype).setTimeout=function(t){this.P=t},c.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},c.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!H&&!this.a.$())){this.A||4!=e||7==n||te(8==n||0>=r?3:2),Oe(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,ne(12),je(this),Te(this);break t}Xt(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ne(this,a)}this.I?(we(this,e,o),H&&this.b&&3==e&&(Ht(this.J,this.R,"tick",this.Va),this.R.start())):(Xt(this.c,this.f,o,null),Ne(this,o)),4==e&&je(this),this.b&&!this.A&&(4==e?Gn(this.g,this):(this.b=!1,Ie(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ne(12)):(this.h=0,ne(13)),je(this),Te(this)}}}catch(c){}},c.Va=function(){if(this.a){var t=jn(this.a),e=this.a.$();this.D<e.length&&(Oe(this),we(this,t,e),this.b&&4!=t&&Ie(this))}},c.cancel=function(){this.A=!0,je(this)},c.Ua=function(){this.o=null;var t=E();0<=t-this.U?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(te(3),ne(17)),je(this),this.h=2,Te(this)):Ee(this,this.U-t)},(c=Ae.prototype).K=function(){Se(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},c.L=function(){return Se(this),this.a.concat()},c.get=function(t,e){return ke(this.b,t)?this.b[t]:e},c.set=function(t,e){ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},c.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Pe){this.a=void 0!==e?e:t.a,Le(this,t.f),this.j=t.j,Ve(this,t.c),Re(this,t.h),this.g=t.g,e=t.b;var n=new Ye;n.c=e.c,e.a&&(n.a=new Ae(e.a),n.b=e.b),Me(this,n),this.i=t.i}else t&&(n=String(t).match(De))?(this.a=!!e,Le(this,n[1]||"",!0),this.j=Fe(n[2]||""),Ve(this,n[3]||"",!0),Re(this,n[4]),this.g=Fe(n[5]||"",!0),Me(this,n[6]||"",!0),this.i=Fe(n[7]||"")):(this.a=!!e,this.b=new Ye(null,this.a))}function Ce(t){return new Pe(t)}function Le(t,e,n){t.f=n?Fe(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ve(t,e,n){t.c=n?Fe(e,!0):e}function Re(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Me(t,e,n){e instanceof Ye?(t.b=e,function(t,e){e&&!t.f&&(Xe(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Je(this,e),Ze(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Be(e,He)),t.b=new Ye(e,t.a))}function Ue(t,e,n){t.b.set(e,n)}function qe(t){return Ue(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^E()).toString(36)),t}function Fe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Be(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ge),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ge(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Be(e,ze,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Be(e,ze,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Be(n,"/"==n.charAt(0)?Qe:Ke,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Be(n,We)),t.join("")};var ze=/[#\/\?@]/g,Ke=/[#\?:]/g,Qe=/[#\?]/g,He=/[#\?@]/g,We=/#/g;function Ye(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Xe(t){t.a||(t.a=new Ae,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Je(t,e){Xe(t),e=tn(t,e),ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Se(t)))}function $e(t,e){return Xe(t),e=tn(t,e),ke(t.a.b,e)}function Ze(t,e,n){Je(t,e),0<n.length&&(t.c=null,t.a.set(tn(t,e),A(n)),t.b+=n.length)}function tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function en(t,e){this.b=t,this.a=e}function nn(t){this.g=t||rn,t=l.PerformanceNavigationTiming?0<(t=l.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(l.ia&&l.ia.ya&&l.ia.ya()&&l.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(c=Ye.prototype).add=function(t,e){Xe(this),this.c=null,t=tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},c.forEach=function(t,e){Xe(this),this.a.forEach((function(n,r){N(n,(function(n){t.call(e,n,r,this)}),this)}),this)},c.L=function(){Xe(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},c.K=function(t){Xe(this);var e=[];if("string"==typeof t)$e(this,t)&&(e=x(e,this.a.get(tn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=x(e,t[n])}return e},c.set=function(t,e){return Xe(this),this.c=null,$e(this,t=tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},c.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},c.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var rn=10;function on(t){return!!t.b||!!t.a&&t.a.size>=t.f}function sn(t){return t.b?1:t.a?t.a.size:0}function un(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function an(t,e){t.a?t.a.add(e):t.b=e}function cn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function hn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=a(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return A(t.c)}function fn(){}function ln(){this.a=new fn}function pn(t,e,n){var r=n||"";try{xe(t,(function(t,n){var i=t;y(t)&&(i=At(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}nn.prototype.cancel=function(){var t,e;if(this.c=hn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=a(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},fn.prototype.stringify=function(t){return l.JSON.stringify(t,void 0)},fn.prototype.parse=function(t){return l.JSON.parse(t,void 0)};var vn=l.JSON.parse;function yn(t){Nt.call(this),this.headers=new Ae,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=gn,this.D=this.F=!1}O(yn,Nt);var gn="",bn=/^https?$/i,mn=["POST","PUT"];function wn(t){return"content-type"==t.toLowerCase()}function _n(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,In(t),On(t)}function In(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function En(t){if(t.b&&void 0!==f&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))Bt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(De)[1]||null;if(!o&&l.self&&l.self.location){var s=l.self.location.protocol;o=s.substr(0,s.length-1)}i=!bn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(a){u=""}t.f=u+" ["+t.X()+"]",In(t)}}finally{On(t)}}}function On(t,e){if(t.a){Tn(t);var n=t.a,r=t.s[0]?p:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Tn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(l.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Nn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return R(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ue(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function An(t){this.pa=0,this.g=[],this.c=new Yt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=xn("baseRetryDelayMs",5e3,t),this.Ma=xn("retryDelaySeedMs",1e4,t),this.Ja=xn("forwardChannelMaxRetries",2,t),this.ma=xn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new nn(t&&t.concurrentRequestLimit),this.ka=new ln,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Sn(t){if(Dn(t),3==t.v){var e=t.R++,n=Ce(t.B);Ue(n,"SID",t.J),Ue(n,"RID",e),Ue(n,"TYPE","terminate"),Vn(t,n),(e=new de(t,t.c,e,void 0)).H=2,e.i=qe(Ce(n)),n=!1,l.navigator&&l.navigator.sendBeacon&&(n=l.navigator.sendBeacon(e.i.toString(),"")),!n&&l.Image&&((new Image).src=e.i,n=!0),n||(e.a=Wn(e.g,null),e.a.ba(e.i)),e.u=E(),Ie(e)}Qn(t)}function kn(t){t.a&&(qn(t),t.a.cancel(),t.a=null)}function Dn(t){kn(t),t.j&&(l.clearTimeout(t.j),t.j=null),Bn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&l.clearTimeout(t.h),t.h=null)}function Pn(t,e){t.g.push(new en(t.La++,e)),3==t.v&&Cn(t)}function Cn(t){on(t.b)||t.h||(t.h=!0,Vt(t.Ba,t),t.u=0)}function Ln(t,e){var n;n=e?e.f:t.R++;var r=Ce(t.B);Ue(r,"SID",t.J),Ue(r,"RID",n),Ue(r,"AID",t.P),Vn(t,r),t.i&&t.l&&Nn(r,t.i,t.l),n=new de(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Rn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),an(t.b,n),be(n,r,e)}function Vn(t,e){t.f&&xe({},(function(t,n){Ue(e,n,t)}))}function Rn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?_(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{pn(h,s,"req"+c+"_")}catch(Ar){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Mn(t){t.a||t.j||(t.U=1,Vt(t.Aa,t),t.o=0)}function Un(t){return!(t.a||t.j||3<=t.o||(t.U++,t.j=ie(_(t.Aa,t),zn(t,t.o)),t.o++,0))}function qn(t){null!=t.s&&(l.clearTimeout(t.s),t.s=null)}function Fn(t){t.a=new de(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ce(t.la);Ue(e,"RID","rpc"),Ue(e,"SID",t.J),Ue(e,"CI",t.H?"0":"1"),Ue(e,"AID",t.P),Vn(t,e),Ue(e,"TYPE","xmlhttp"),t.i&&t.l&&Nn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=qe(Ce(e)),n.j=null,n.I=!0,me(n,t)}function Bn(t){null!=t.m&&(l.clearTimeout(t.m),t.m=null)}function Gn(t,e){var n=null;if(t.a==e){Bn(t),qn(t),t.a=null;var r=2}else{if(!un(t.b,e))return;n=e.s,cn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=E()-e.u;var i=t.u;(r=$t()).dispatchEvent(new re(r,n,e,i)),Cn(t)}else Mn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(sn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=ie(_(t.Ba,t,e),zn(t,t.u)),t.u++,0)))}(t,e)||2==r&&Un(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Kn(t,5);break;case 4:Kn(t,10);break;case 3:Kn(t,6);break;default:Kn(t,2)}}function zn(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function Kn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=_(t.Xa,t);n||(n=new Pe("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Le(n,"https"),qe(n)),function(t,e){var n=new Yt;if(l.Image){var r=new Image;r.onload=I(dn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=I(dn,n,r,"TestLoadImage: error",!1,e),r.onabort=I(dn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=I(dn,n,r,"TestLoadImage: timeout",!1,e),l.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else ne(2);t.v=0,t.f&&t.f.ra(e),Qn(t),Dn(t)}function Qn(t){t.v=0,t.I=-1,t.f&&(0==hn(t.b).length&&0==t.g.length||(t.b.c.length=0,A(t.g),t.g.length=0),t.f.qa())}function Hn(t,e,n){var r=function(t){return t instanceof Pe?Ce(t):new Pe(t,void 0)}(n);if(""!=r.c)e&&Ve(r,e+"."+r.c),Re(r,r.h);else{var i=l.location;r=function(t,e,n,r){var i=new Pe(null,void 0);return t&&Le(i,t),e&&Ve(i,e),n&&Re(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&R(t.W,(function(t,e){Ue(r,e,t)})),n=t.na,(e=t.A)&&n&&Ue(r,e,n),Ue(r,"VER",t.ha),Vn(t,r),r}function Wn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new yn(t.Ka)).F=t.C,e}function Yn(){}function Xn(){if(K&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function Jn(t,e){Nt.call(this),this.a=new An(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!S(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!S(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new tr(this)}function $n(t){fe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Zn(){le.call(this),this.status=1}function tr(t){this.a=t}(c=yn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:ce),this.a.onreadystatechange=_(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void _n(this,o)}t=n||"";var i=new Ae(this.headers);r&&xe(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=wn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=l.FormData&&t instanceof l.FormData,!(0<=j(mn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Tn(this),0<this.o&&((this.D=function(t){return K&&et(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.xa,this)):this.m=Bt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){_n(this,o)}},c.xa=function(){void 0!==f&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},c.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),On(this))},c.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),On(this,!0)),yn.S.G.call(this)},c.za=function(){this.j||(this.A||this.l||this.g?En(this):this.Ta())},c.Ta=function(){En(this)},c.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(G){return-1}},c.$=function(){try{return this.a?this.a.responseText:""}catch(G){return""}},c.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),vn(e)}},c.ua=function(){return this.h},c.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(c=An.prototype).ha=8,c.v=1,c.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new de(this,this.c,t,void 0),r=this.l;if(this.O&&(r?q(r=M(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Rn(this,n,e),Ue(i=Ce(this.B),"RID",t),Ue(i,"CVER",22),this.A&&Ue(i,"X-HTTP-Session-Id",this.A),Vn(this,i),this.i&&r&&Nn(i,this.i,r),an(this.b,n),this.Ga&&Ue(i,"TYPE","init"),this.da?(Ue(i,"$req",e),Ue(i,"SID","null"),n.V=!0,be(n,i,null)):be(n,i,e),this.v=2}}else 3==this.v&&(t?Ln(this,t):0==this.g.length||on(this.b)||Ln(this))},c.Aa=function(){if(this.j=null,Fn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ie(_(this.Sa,this),t)}},c.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,kn(this),Fn(this))},c.Ra=function(){null!=this.m&&(this.m=null,kn(this),Un(this),ne(19))},c.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),ne(2)):(this.c.info("Failed to ping google.com"),ne(1))},(c=Yn.prototype).ta=function(){},c.sa=function(){},c.ra=function(){},c.qa=function(){},c.Ha=function(){},Xn.prototype.a=function(t,e){return new Jn(t,e)},O(Jn,Nt),(c=Jn.prototype).addEventListener=function(t,e,n,r){Jn.S.addEventListener.call(this,t,e,n,r)},c.removeEventListener=function(t,e,n,r){Jn.S.removeEventListener.call(this,t,e,n,r)},c.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ne(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=Hn(t,null,t.fa),Cn(t)},c.close=function(){Sn(this.a)},c.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,Pn(this.a,e)}else this.g?((e={}).__data__=At(t),Pn(this.a,e)):Pn(this.a,t)},c.G=function(){this.a.f=null,delete this.f,Sn(this.a),delete this.a,Jn.S.G.call(this)},O($n,fe),O(Zn,le),O(tr,Yn),tr.prototype.ta=function(){this.a.dispatchEvent("a")},tr.prototype.sa=function(t){this.a.dispatchEvent(new $n(t))},tr.prototype.ra=function(t){this.a.dispatchEvent(new Zn(t))},tr.prototype.qa=function(){this.a.dispatchEvent("b")},Xn.prototype.createWebChannel=Xn.prototype.a,Jn.prototype.send=Jn.prototype.Pa,Jn.prototype.open=Jn.prototype.Oa,Jn.prototype.close=Jn.prototype.close,oe.NO_ERROR=0,oe.TIMEOUT=8,oe.HTTP_ERROR=6,se.COMPLETE="complete",ae.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",Nt.prototype.listen=Nt.prototype.va,yn.prototype.listenOnce=yn.prototype.wa,yn.prototype.getLastError=yn.prototype.Qa,yn.prototype.getLastErrorCode=yn.prototype.ua,yn.prototype.getStatus=yn.prototype.X,yn.prototype.getResponseJson=yn.prototype.Na,yn.prototype.getResponseText=yn.prototype.$,yn.prototype.send=yn.prototype.ba;var er=oe,nr=se,rr=ae,ir=yn,or=n("/6Yf"),sr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},ur=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ar=new o.b("@firebase/firestore");function cr(){return ar.logLevel}function hr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ar.logLevel<=o.a.DEBUG){var i=e.map(pr);ar.debug.apply(ar,Object(r.h)(["Firestore (8.0.2): "+t],i))}}function fr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ar.logLevel<=o.a.ERROR){var i=e.map(pr);ar.error.apply(ar,Object(r.h)(["Firestore (8.0.2): "+t],i))}}function lr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ar.logLevel<=o.a.WARN){var i=e.map(pr);ar.warn.apply(ar,Object(r.h)(["Firestore (8.0.2): "+t],i))}}function pr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function dr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.2) INTERNAL ASSERTION FAILED: "+t;throw fr(e),new Error(e)}function vr(t,e){t||dr()}function yr(t,e){return t}function gr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var br=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=gr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function mr(t,e){return t<e?-1:t>e?1:0}function wr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function _r(t){return t+"\0"}function Ir(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Or(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Tr=function(){function t(t,e){this.h=t,this.l=e,this._={}}return t.prototype.get=function(t){var e=this.h(t),n=this._[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.l(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Er(this._,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.T=function(){return Or(this._)},t}(),jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(r.d)(e,t),e}(Error),xr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Nr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Nr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Nr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.I=function(t){return this.seconds===t.seconds?mr(this.nanoseconds,t.nanoseconds):mr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Ar=function(){function t(t){this.timestamp=t}return t.m=function(e){return new t(e)},t.min=function(){return new t(new xr(0,0))},t.prototype.A=function(t){return this.timestamp.I(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.P=function(){return this.timestamp},t}(),Sr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&dr(),void 0===n?n=t.length-e:n>t.length-e&&dr(),this.segments=t,this.offset=e,this.g=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.g},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.V(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.p(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.v=function(t){return this.p(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.S=function(){return this.p(this.segments,this.offset,this.length-1)},t.prototype.D=function(){return this.segments[this.offset]},t.prototype.C=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.T=function(){return 0===this.length},t.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},t.V=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),kr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.p=function(t,n,r){return new e(t,n,r)},e.prototype.M=function(){return this.O().join("/")},e.prototype.toString=function(){return this.M()},e.k=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Nr(jr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.$=function(){return new e([])},e}(Sr),Dr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Pr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.p=function(t,n,r){return new e(t,n,r)},e.L=function(t){return Dr.test(t)},e.prototype.M=function(){return this.O().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.L(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.M()},e.prototype.B=function(){return 1===this.length&&"__name__"===this.get(0)},e.q=function(){return new e(["__name__"])},e.U=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Nr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Nr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Nr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Nr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.$=function(){return new e([])},e}(Sr),Cr=function(){function t(t){this.path=t}return t.K=function(e){return new t(kr.k(e))},t.W=function(e){return new t(kr.k(e).v(5))},t.prototype.j=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===kr.V(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.V=function(t,e){return kr.V(t.path,e.path)},t.G=function(t){return t.length%2==0},t.H=function(e){return new t(new kr(e.slice()))},t}();function Lr(t){return null==t}function Vr(t){return 0===t&&1/t==-1/0}function Rr(t){return"number"==typeof t&&Number.isInteger(t)&&!Vr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Mr=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.J=null};function Ur(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mr(t,e,n,r,i,o,s)}function qr(t){var e=yr(t);if(null===e.J){var n=e.path.M();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.M()+t.op.toString()+ki(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.M()+e.dir;var e})).join(","),Lr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Cs(e.startAt)),e.endAt&&(n+="|ub:",n+=Cs(e.endAt)),e.J=n}return e.J}function Fr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Us(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Ni(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vs(t.startAt,e.startAt)&&Vs(t.endAt,e.endAt)}function Br(t){return Cr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Gr=function(){function t(t){this.Y=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.Y)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Y)},t.prototype.X=function(){return 2*this.Y.length},t.prototype.A=function(t){return mr(this.Y,t.Y)},t.prototype.isEqual=function(t){return this.Y===t.Y},t}();Gr.Z=new Gr("");var zr,Kr,Qr=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Ar.min()),void 0===o&&(o=Ar.min()),void 0===s&&(s=Gr.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}(),Hr=function(t){this.count=t};function Wr(t){switch(t){case jr.OK:return dr();case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return!1;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return!0;default:return dr()}}function Yr(t){if(void 0===t)return fr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case zr.OK:return jr.OK;case zr.CANCELLED:return jr.CANCELLED;case zr.UNKNOWN:return jr.UNKNOWN;case zr.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case zr.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case zr.INTERNAL:return jr.INTERNAL;case zr.UNAVAILABLE:return jr.UNAVAILABLE;case zr.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case zr.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case zr.NOT_FOUND:return jr.NOT_FOUND;case zr.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case zr.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case zr.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case zr.ABORTED:return jr.ABORTED;case zr.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case zr.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case zr.DATA_LOSS:return jr.DATA_LOSS;default:return dr()}}(Kr=zr||(zr={}))[Kr.OK=0]="OK",Kr[Kr.CANCELLED=1]="CANCELLED",Kr[Kr.UNKNOWN=2]="UNKNOWN",Kr[Kr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kr[Kr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kr[Kr.NOT_FOUND=5]="NOT_FOUND",Kr[Kr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kr[Kr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kr[Kr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kr[Kr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kr[Kr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kr[Kr.ABORTED=10]="ABORTED",Kr[Kr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kr[Kr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kr[Kr.INTERNAL=13]="INTERNAL",Kr[Kr.UNAVAILABLE=14]="UNAVAILABLE",Kr[Kr.DATA_LOSS=15]="DATA_LOSS";var Xr=function(){function t(t,e){this.V=t,this.root=e||$r.EMPTY}return t.prototype.rt=function(e,n){return new t(this.V,this.root.rt(e,n,this.V).copy(null,null,$r.ot,null,null))},t.prototype.remove=function(e){return new t(this.V,this.root.remove(e,this.V).copy(null,null,$r.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.V(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.V(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.T=function(){return this.root.T()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new Jr(this.root,null,this.V,!1)},t.prototype._t=function(t){return new Jr(this.root,t,this.V,!1)},t.prototype.ft=function(){return new Jr(this.root,null,this.V,!0)},t.prototype.dt=function(t){return new Jr(this.root,t,this.V,!0)},t}(),Jr=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.T();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),$r=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.T=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.T()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.T())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.Vt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.T()||i.left.gt()||i.left.left.gt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.yt()),i.right.T()||i.right.gt()||i.right.left.gt()||(i=i.vt()),0===n(e,i.key)){if(i.right.T())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.bt()),t.left.gt()&&t.left.left.gt()&&(t=t.yt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.Vt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.yt())).bt()).St()),t},t.prototype.vt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.yt()).St()),t},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.yt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw dr();if(this.right.gt())throw dr();var t=this.left.Ct();if(t!==this.right.Ct())throw dr();return t+(this.gt()?0:1)},t}();$r.EMPTY=null,$r.RED=!0,$r.ot=!1,$r.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw dr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new $r(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.T=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());var Zr=function(){function t(t){this.V=t,this.data=new Xr(this.V)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.V(r.key,t[1])>=0)return;e(r.key)}},t.prototype.xt=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.Ft=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new ti(this.data.lt())},t.prototype._t=function(t){return new ti(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.T=function(){return this.data.T()},t.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.V(i,o))return!1}return!0},t.prototype.O=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.V);return n.data=e,n},t}(),ti=function(){function t(t){this.Mt=t}return t.prototype.Et=function(){return this.Mt.Et().key},t.prototype.It=function(){return this.Mt.It()},t}(),ei=new Xr(Cr.V);function ni(){return ei}function ri(){return ni()}var ii=new Xr(Cr.V);function oi(){return ii}var si=new Xr(Cr.V),ui=new Zr(Cr.V);function ai(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ui,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ci=new Zr(mr);function hi(){return ci}var fi=function(){function t(t){this.V=t?function(e,n){return t(e,n)||Cr.V(e.key,n.key)}:function(t,e){return Cr.V(t.key,e.key)},this.kt=oi(),this.$t=new Xr(this.V)}return t.Lt=function(e){return new t(e.V)},t.prototype.has=function(t){return null!=this.kt.get(t)},t.prototype.get=function(t){return this.kt.get(t)},t.prototype.first=function(){return this.$t.at()},t.prototype.last=function(){return this.$t.ct()},t.prototype.T=function(){return this.$t.T()},t.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.$t.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.rt(t.key,t),e.$t.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.$t.lt(),r=e.$t.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.V=this.V,r.kt=e,r.$t=n,r},t}(),li=function(){function t(){this.Bt=new Xr(Cr.V)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):dr():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut((function(e,n){t.push(n)})),t},t}(),pi=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Kt=s,this.Wt=u}return t.jt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,fi.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Kt===t.Kt&&this.Qt.isEqual(t.Qt)&&ms(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),di=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}return t.Yt=function(e,n){var r=new Map;return r.set(e,vi.Xt(e,n)),new t(Ar.min(),r,hi(),ni(),ai())},t}(),vi=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t(Gr.Z,n,ai(),ai(),ai())},t}(),yi=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},gi=function(t,e){this.targetId=t,this.re=e},bi=function(t,e,n,r){void 0===n&&(n=Gr.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mi=function(){function t(){this.oe=0,this.ae=Ii(),this.ce=Gr.Z,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.X()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=ai(),e=ai(),n=ai();return this.ae.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:dr()}})),new vi(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=Ii()},t.prototype.Te=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Ee=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ie=function(){this.oe+=1},t.prototype.me=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),wi=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=ni(),this.Ve=_i(),this.ye=new Zr(mr)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof rs?this.ve(r,t.ie):t.ie instanceof is&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.be(o[i],t.key,t.ie)},t.prototype.Se=function(t){var e=this;this.De(t,(function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.me(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.me(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.xe(n),r.fe(t.resumeToken));break;default:dr()}}))},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Ne(r)&&e(r)}))},t.prototype.Fe=function(t){var e=t.targetId,n=t.re.count,r=this.Oe(e);if(r){var i=r.target;if(Br(i))if(0===n){var o=new Cr(i.path);this.be(e,o,new is(o,Ar.min()))}else vr(1===n);else this.Me(e)!==n&&(this.xe(e),this.ye=this.ye.add(e))}},t.prototype.ke=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.Oe(i);if(o){if(r.Zt&&Br(o.target)){var s=new Cr(o.target.path);null!==e.ge.get(s)||e.$e(i,s)||e.be(i,s,new is(s,t))}r._e&&(n.set(i,r.de()),r.we())}}));var r=ai();this.Ve.forEach((function(t,n){var i=!0;n.xt((function(t){var n=e.Oe(t);return!n||2===n.tt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new di(t,n,this.ye,this.ge,r);return this.ge=ni(),this.Ve=_i(),this.ye=new Zr(mr),i},t.prototype.ve=function(t,e){if(this.Ne(t)){var n=this.$e(t,e.key)?2:0;this.Ce(t).Te(e.key,n),this.ge=this.ge.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Le(e.key).add(t))}},t.prototype.be=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.$e(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.Me=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ie=function(t){this.Ce(t).Ie()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new mi,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.Ve.get(t);return e||(e=new Zr(mr),this.Ve=this.Ve.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.Oe(t);return e||hr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Oe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.xe=function(t){var e=this;this.Pe.set(t,new mi),this.Re.Be(t).forEach((function(n){e.be(t,n,null)}))},t.prototype.$e=function(t,e){return this.Re.Be(t).has(e)},t}();function _i(){return new Xr(Cr.V)}function Ii(){return new Xr(Cr.V)}function Ei(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Oi(t){var e=Di(t.mapValue.fields.__local_write_time__.timestampValue);return new xr(e.seconds,e.nanos)}var Ti=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ji(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ei(t)?4:10:dr()}function Ni(t,e){var n=ji(t);if(n!==ji(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Oi(t).isEqual(Oi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Di(t.timestampValue),r=Di(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ci(t.bytesValue).isEqual(Ci(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Pi(t.geoPointValue.latitude)===Pi(e.geoPointValue.latitude)&&Pi(t.geoPointValue.longitude)===Pi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Pi(t.integerValue)===Pi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Pi(t.doubleValue),r=Pi(e.doubleValue);return n===r?Vr(n)===Vr(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return wr(t.arrayValue.values||[],e.arrayValue.values||[],Ni);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ir(n)!==Ir(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ni(n[i],r[i])))return!1;return!0}(t,e);default:return dr()}}function xi(t,e){return void 0!==(t.values||[]).find((function(t){return Ni(t,e)}))}function Ai(t,e){var n=ji(t),r=ji(e);if(n!==r)return mr(n,r);switch(n){case 0:return 0;case 1:return mr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Pi(t.integerValue||t.doubleValue),r=Pi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Si(t.timestampValue,e.timestampValue);case 4:return Si(Oi(t),Oi(e));case 5:return mr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ci(t),r=Ci(e);return n.A(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=mr(n[i],r[i]);if(0!==o)return o}return mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=mr(Pi(t.latitude),Pi(e.latitude));return 0!==n?n:mr(Pi(t.longitude),Pi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ai(n[i],r[i]);if(o)return o}return mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=mr(r[s],o[s]);if(0!==u)return u;var a=Ai(n[r[s]],i[o[s]]);if(0!==a)return a}return mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw dr()}}function Si(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return mr(t,e);var n=Di(t),r=Di(e),i=mr(n.seconds,r.seconds);return 0!==i?i:mr(n.nanos,r.nanos)}function ki(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=Di(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ci(e.bytesValue).toBase64():"referenceValue"in e?Cr.W(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):dr();var n}(t)}function Di(t){if(vr(!!t),"string"==typeof t){var e=0,n=Ti.exec(t);if(vr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pi(t.seconds),nanos:Pi(t.nanos)}}function Pi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ci(t){return"string"==typeof t?Gr.fromBase64String(t):Gr.fromUint8Array(t)}function Li(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.M()}}function Vi(t){return!!t&&"integerValue"in t}function Ri(t){return!!t&&"arrayValue"in t}function Mi(t){return!!t&&"nullValue"in t}function Ui(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qi(t){return!!t&&"mapValue"in t}var Fi={asc:"ASCENDING",desc:"DESCENDING"},Bi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Gi=function(t,e){this.t=t,this.Ue=e};function zi(t){return{integerValue:""+t}}function Ki(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vr(e)?"-0":e}}function Qi(t,e){return Rr(e)?zi(e):Ki(t,e)}function Hi(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wi(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function Yi(t,e){return Hi(t,e.P())}function Xi(t){return vr(!!t),Ar.m(function(t){var e=Di(t);return new xr(e.seconds,e.nanos)}(t))}function Ji(t,e){return function(t){return new kr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).M()}function $i(t){var e=kr.k(t);return vr(_o(e)),e}function Zi(t,e){return Ji(t.t,e.path)}function to(t,e){var n=$i(e);if(n.get(1)!==t.t.projectId)throw new Nr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Nr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Cr(io(n))}function eo(t,e){return Ji(t.t,e)}function no(t){var e=$i(t);return 4===e.length?kr.$():io(e)}function ro(t){return new kr(["projects",t.t.projectId,"databases",t.t.database]).M()}function io(t){return vr(t.length>4&&"documents"===t.get(4)),t.v(5)}function oo(t,e,n){return{name:Zi(t,e),fields:n.proto.mapValue.fields}}function so(t,e){var n;if(e instanceof Ko)n={update:oo(t,e.key,e.value)};else if(e instanceof Jo)n={delete:Zi(t,e.key)};else if(e instanceof Qo)n={update:oo(t,e.key,e.data),updateMask:wo(e.Qe)};else if(e instanceof Wo)n={transform:{document:Zi(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof jo)return{fieldPath:e.field.M(),setToServerValue:"REQUEST_TIME"};if(n instanceof No)return{fieldPath:e.field.M(),appendMissingElements:{values:n.elements}};if(n instanceof Ao)return{fieldPath:e.field.M(),removeAllFromArray:{values:n.elements}};if(n instanceof ko)return{fieldPath:e.field.M(),increment:n.Ke};throw dr()}(0,t)}))}};else{if(!(e instanceof $o))return dr();n={verify:Zi(t,e.key)}}return e.je.We||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Yi(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:dr()}(t,e.je)),n}function uo(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ro.updateTime(Xi(t.updateTime)):void 0!==t.exists?Ro.exists(t.exists):Ro.Ge()}(e.currentDocument):Ro.Ge();if(e.update){var r=to(t,e.update.name),i=new Zo({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new Co((t.fieldPaths||[]).map((function(t){return Pr.U(t)})))}(e.updateMask);return new Qo(r,i,o,n)}return new Ko(r,i,n)}if(e.delete){var s=to(t,e.delete);return new Jo(s,n)}if(e.transform){var u=to(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(vr("REQUEST_TIME"===e.setToServerValue),n=new jo):"appendMissingElements"in e?n=new No(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ao(e.removeAllFromArray.values||[]):"increment"in e?n=new ko(t,e.increment):dr();var r=Pr.U(e.fieldPath);return new Lo(r,n)}(t,e)}));return vr(!0===n.exists),new Wo(u,a)}if(e.verify){var c=to(t,e.verify);return new $o(c,n)}return dr()}function ao(t,e){return{documents:[eo(t,e.path)]}}function co(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=eo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=eo(t,r.S()),n.structuredQuery.from=[{collectionId:r.C()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ui(t.value))return{unaryFilter:{field:yo(t.field),op:"IS_NAN"}};if(Mi(t.value))return{unaryFilter:{field:yo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ui(t.value))return{unaryFilter:{field:yo(t.field),op:"IS_NOT_NAN"}};if(Mi(t.value))return{unaryFilter:{field:yo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(t.field),op:vo(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:yo(t.field),direction:po(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||Lr(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=fo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=fo(e.endAt)),n}function ho(t){var e=no(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){vr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[mo(e)]:void 0!==e.fieldFilter?[bo(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):dr():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new Rs(go(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return Lr(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=lo(n.startAt));var h=null;return n.endAt&&(h=lo(n.endAt)),us(e,i,u,s,a,"F",c,h)}function fo(t){return{before:t.before,values:t.position}}function lo(t){return new Ps(t.values||[],!!t.before)}function po(t){return Fi[t]}function vo(t){return Bi[t]}function yo(t){return{fieldPath:t.M()}}function go(t){return Pr.U(t.fieldPath)}function bo(t){return Os.create(go(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return dr()}}(t.fieldFilter.op),t.fieldFilter.value)}function mo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=go(t.unaryFilter.field);return Os.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=go(t.unaryFilter.field);return Os.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=go(t.unaryFilter.field);return Os.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=go(t.unaryFilter.field);return Os.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return dr()}}function wo(t){var e=[];return t.fields.forEach((function(t){return e.push(t.M())})),{fieldPaths:e}}function _o(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Io=function(){this.ze=void 0};function Eo(t,e,n){return t instanceof jo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof No?xo(t,e):t instanceof Ao?So(t,e):function(t,e){var n=To(t,e),r=Do(n)+Do(t.Ke);return Vi(n)&&Vi(t.Ke)?zi(r):Ki(t.serializer,r)}(t,e)}function Oo(t,e,n){return t instanceof No?xo(t,e):t instanceof Ao?So(t,e):n}function To(t,e){return t instanceof ko?Vi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e}(Io),No=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(r.d)(e,t),e}(Io);function xo(t,e){for(var n=Po(e),r=function(t){n.some((function(e){return Ni(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ao=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(r.d)(e,t),e}(Io);function So(t,e){for(var n=Po(e),r=function(t){n=n.filter((function(e){return!Ni(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ko=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.Ke=n,r}return Object(r.d)(e,t),e}(Io);function Do(t){return Pi(t.integerValue||t.doubleValue)}function Po(t){return Ri(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Co=function(){function t(t){this.fields=t,t.sort(Pr.V)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},t.prototype.isEqual=function(t){return wr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Lo=function(t,e){this.field=t,this.transform=e},Vo=function(t,e){this.version=t,this.transformResults=e},Ro=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Mo(t,e){return void 0!==t.updateTime?e instanceof rs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof rs}var Uo=function(){};function qo(t,e,n){return t instanceof Ko?function(t,e,n){return new rs(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Qo?function(t,e,n){if(!Mo(t.je,e))return new os(t.key,n.version);var r=Ho(t,e);return new rs(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Wo?function(t,e,n){if(vr(null!=n.transformResults),!Mo(t.je,e))return new os(t.key,n.version);var r=Yo(0,e),i=function(t,e,n){var r=[];vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof rs&&(u=e.field(o.field)),r.push(Oo(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Xo(t,r.data(),i);return new rs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new is(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Fo(t,e,n,r){return t instanceof Ko?function(t,e){if(!Mo(t.je,e))return e;var n=zo(e);return new rs(t.key,n,t.value,{Je:!0})}(t,e):t instanceof Qo?function(t,e){if(!Mo(t.je,e))return e;var n=zo(e),r=Ho(t,e);return new rs(t.key,n,r,{Je:!0})}(t,e):t instanceof Wo?function(t,e,n,r){if(!Mo(t.je,e))return e;var i=Yo(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof rs&&(c=n.field(u.field)),null===c&&r instanceof rs&&(c=r.field(u.field)),i.push(Eo(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Xo(t,i.data(),o);return new rs(t.key,i.version,s,{Je:!0})}(t,e,r,n):function(t,e){return Mo(t.je,e)?new is(t.key,Ar.min()):e}(t,e)}function Bo(t,e){return t instanceof Wo?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof rs?e.field(o.field):void 0,u=To(o.transform,s||null);null!=u&&(n=null==n?(new ts).set(o.field,u):n.set(o.field,u))}return n?n.Ye():null}(t,e):null}function Go(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.je.isEqual(e.je)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||wr(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof No&&e instanceof No||t instanceof Ao&&e instanceof Ao?wr(t.elements,e.elements,Ni):t instanceof ko&&e instanceof ko?Ni(t.Ke,e.Ke):t instanceof jo&&e instanceof jo}(t.transform,e.transform)}(t,e)})))}function zo(t){return t instanceof rs?t.version:Ar.min()}var Ko=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.je=r,i.type=0,i}return Object(r.d)(e,t),e}(Uo),Qo=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.je=i,o.type=1,o}return Object(r.d)(e,t),e}(Uo);function Ho(t,e){return function(t,e){var n=new ts(e);return t.Qe.fields.forEach((function(e){if(!e.T()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Ye()}(t,e instanceof rs?e.data():Zo.empty())}var Wo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.je=Ro.exists(!0),r}return Object(r.d)(e,t),e}(Uo);function Yo(t,e){return e}function Xo(t,e,n){for(var r=new ts(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Ye()}var Jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.je=n,r.type=3,r}return Object(r.d)(e,t),e}(Uo),$o=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.je=n,r.type=4,r}return Object(r.d)(e,t),e}(Uo),Zo=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.C()])||null},t.prototype.isEqual=function(t){return Ni(this.proto,t.proto)},t}(),ts=function(){function t(t){void 0===t&&(t=Zo.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ji(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.C(),e)},t.prototype.Ye=function(){var t=this.en(Pr.$(),this.Ze);return null!=t?new Zo(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=qi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function es(t){var e=[];return Er(t.fields||{},(function(t,n){var r=new Pr([t]);if(qi(n)){var i=es(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new Co(e)}var ns=function(t,e){this.key=t,this.version=e},rs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).nn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(r.d)(e,t),e.prototype.field=function(t){return this.nn.field(t)},e.prototype.data=function(){return this.nn},e.prototype.sn=function(){return this.nn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(ns),is=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(r.d)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(ns),os=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(ns),ss=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null};function us(t,e,n,r,i,o,s,u){return new ss(t,e,n,r,i,o,s,u)}function as(t){return new ss(t)}function cs(t){return!Lr(t.limit)&&"F"===t.limitType}function hs(t){return!Lr(t.limit)&&"L"===t.limitType}function fs(t){return t.rn.length>0?t.rn[0].field:null}function ls(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function ps(t){return null!==t.collectionGroup}function ds(t){var e=yr(t);if(null===e.on){e.on=[];var n=ls(e),r=fs(e);if(null!==n&&null===r)n.B()||e.on.push(new Rs(n)),e.on.push(new Rs(Pr.q(),"asc"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var u=s[o];e.on.push(u),u.field.B()&&(i=!0)}if(!i){var a=e.rn.length>0?e.rn[e.rn.length-1].dir:"asc";e.on.push(new Rs(Pr.q(),a))}}}return e.on}function vs(t){var e=yr(t);if(!e.an)if("F"===e.limitType)e.an=Ur(e.path,e.collectionGroup,ds(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ds(e);r<i.length;r++){var o=i[r];n.push(new Rs(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Ps(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ps(e.startAt.position,!e.startAt.before):null;e.an=Ur(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.an}function ys(t,e,n){return new ss(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gs(t,e){return new ss(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function bs(t,e){return new ss(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function ms(t,e){return Fr(vs(t),vs(e))&&t.limitType===e.limitType}function ws(t){return qr(vs(t))+"|lt:"+t.limitType}function _s(t){return"Query(target="+function(t){var e=t.path.M();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.M()+" "+e.op+" "+ki(e.value);var e})).join(", ")+"]"),Lr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.M()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Cs(t.startAt)),t.endAt&&(e+=", endAt: "+Cs(t.endAt)),"Target("+e+")"}(vs(t))+"; limitType="+t.limitType+")"}function Is(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.j(t.collectionGroup)&&t.path.N(n):Cr.G(t.path)?t.path.isEqual(n):t.path.F(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.B()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ls(t.startAt,ds(t),e)||t.endAt&&Ls(t.endAt,ds(t),e))}(t,e)}function Es(t){return function(e,n){for(var r=!1,i=0,o=ds(t);i<o.length;i++){var s=o[i],u=Ms(s,e,n);if(0!==u)return u;r=r||s.field.B()}return 0}}var Os=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(r.d)(e,t),e.create=function(t,n,r){return t.B()?"in"===n||"not-in"===n?this.un(t,n,r):new Ts(t,n,r):"array-contains"===n?new As(t,r):"in"===n?new Ss(t,r):"not-in"===n?new ks(t,r):"array-contains-any"===n?new Ds(t,r):new e(t,n,r)},e.un=function(t,e,n){return"in"===e?new js(t,n):new Ns(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.hn(Ai(e,this.value)):null!==e&&ji(this.value)===ji(e)&&this.hn(Ai(e,this.value))},e.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return dr()}},e.prototype.cn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ts=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Cr.W(r.referenceValue),i}return Object(r.d)(e,t),e.prototype.matches=function(t){var e=Cr.V(t.key,this.key);return this.hn(e)},e}(Os),js=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=xs(0,n),r}return Object(r.d)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Os),Ns=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=xs(0,n),r}return Object(r.d)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Os);function xs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Cr.W(t.referenceValue)}))}var As=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(r.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Ri(e)&&xi(e.arrayValue,this.value)},e}(Os),Ss=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(r.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&xi(this.value.arrayValue,e)},e}(Os),ks=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(r.d)(e,t),e.prototype.matches=function(t){if(xi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!xi(this.value.arrayValue,e)},e}(Os),Ds=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(r.d)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ri(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return xi(e.value.arrayValue,t)}))},e}(Os),Ps=function(t,e){this.position=t,this.before=e};function Cs(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ki(t)})).join(",")}function Ls(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.B()?Cr.V(Cr.W(s.referenceValue),n.key):Ai(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Vs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ni(t.position[n],e.position[n]))return!1;return!0}var Rs=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ms(t,e,n){var r=t.field.B()?Cr.V(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Ai(r,i):dr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return dr()}}function Us(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var qs=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Fs=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.mn=function(){this.Tn=this.wn},t.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Rn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&hr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.Pn(this._n,i,(function(){return e.In=Date.now(),t()})),this.Tn*=this.dn,this.Tn<this.fn&&(this.Tn=this.fn),this.Tn>this.wn&&(this.Tn=this.wn)},t.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Rn=function(){return(Math.random()-.5)*this.Tn},t}(),Bs=function(){function t(t){var e=this;this.yn=null,this.pn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t((function(t){e.vn=!0,e.result=t,e.yn&&e.yn(t)}),(function(t){e.vn=!0,e.error=t,e.pn&&e.pn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.bn&&dr(),this.bn=!0,this.vn?this.error?this.Sn(n,this.error):this.Dn(e,this.result):new t((function(t,i){r.yn=function(n){r.Dn(e,n).next(t,i)},r.pn=function(e){r.Sn(n,e).next(t,i)}}))},t.prototype.Cn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Nn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Dn=function(e,n){return e?this.Nn((function(){return e(n)})):t.resolve(n)},t.prototype.Sn=function(e,n){return e?this.Nn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.xn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Fn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.xn(r)},t}(),Gs=function(){function t(e,n,r){this.name=e,this.version=n,this.On=r,12.2===t.Mn(Object(s.g)())&&fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return hr("SimpleDb","Removing database:",t),Ys(window.indexedDB.deleteDatabase(t)).Cn()},t.kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.$n())return!0;var e=Object(s.g)(),n=t.Mn(e),r=0<n&&n<10,i=t.Ln(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.$n=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},t.qn=function(t,e){return t.store(e)},t.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Ln=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Un=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(hr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ks(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Nr(jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ks(t,n))},i.onupgradeneeded=function(t){hr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.On.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){hr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return n.Qn(t)}),this.db)]}}))}))},t.prototype.Kn=function(t){this.Qn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s,u,a,c;return Object(r.e)(this,(function(h){switch(h.label){case 0:o="readonly"===e,s=0,u=function(){var e,u,c,h,f;return Object(r.e)(this,(function(r){switch(r.label){case 0:++s,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,a.Un(t)];case 2:return a.db=r.sent(),e=Hs.open(a.db,t,o?"readonly":"readwrite",n),u=i(e).catch((function(t){return e.abort(t),Bs.reject(t)})).Cn(),c={},u.catch((function(){})),[4,e.Wn];case 3:return[2,(c.value=(r.sent(),u),c)];case 4:return hr("SimpleDb","Transaction failed with error:",(h=r.sent()).message,"Retrying:",f="FirebaseError"!==h.name&&s<3),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,u()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),zs=function(){function t(t){this.jn=t,this.Gn=!1,this.zn=null}return Object.defineProperty(t.prototype,"vn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.jn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Gn=!0},t.prototype.Jn=function(t){this.zn=t},t.prototype.delete=function(){return Ys(this.jn.delete())},t}(),Ks=function(t){function e(e,n){var r=this;return(r=t.call(this,jr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(r.d)(e,t),e}(Nr);function Qs(t){return"IndexedDbTransactionError"===t.name}var Hs=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Yn=new qs,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){e.error?n.Yn.reject(new Ks(t,e.error)):n.Yn.resolve()},this.transaction.onerror=function(e){var r=Js(e.target.error);n.Yn.reject(new Ks(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ks(n,e)}},Object.defineProperty(t.prototype,"Wn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(hr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ws(e)},t}(),Ws=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(hr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(hr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ys(n)},t.prototype.add=function(t){return hr("SimpleDb","ADD",this.store.name,t,t),Ys(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ys(this.store.get(t)).next((function(n){return void 0===n&&(n=null),hr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return hr("SimpleDb","DELETE",this.store.name,t),Ys(this.store.delete(t))},t.prototype.count=function(){return hr("SimpleDb","COUNT",this.store.name),Ys(this.store.count())},t.prototype.Xn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Zn(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ts=function(t,e){hr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.es=!1;var r=this.cursor(n);return this.Zn(r,(function(t,e,n){return n.delete()}))},t.prototype.ns=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Zn(r,e)},t.prototype.ss=function(t){var e=this.cursor({});return new Bs((function(n,r){e.onerror=function(t){var e=Js(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Zn=function(t,e){var n=[];return new Bs((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new zs(i),s=e(i.primaryKey,i.value,o);if(s instanceof Bs){var u=s.catch((function(t){return o.done(),Bs.reject(t)}));n.push(u)}o.vn?r():null===o.Hn?i.continue():i.continue(o.Hn)}else r()}})).next((function(){return Bs.xn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ys(t){return new Bs((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Js(t.target.error);n(e)}}))}var Xs=!1;function Js(t){var e=Gs.Mn(Object(s.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Nr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xs||(Xs=!0,setTimeout((function(){throw r}),0)),r}}return t}function $s(){return"undefined"!=typeof window?window:null}function Zs(){return"undefined"!=typeof document?document:null}var tu=function(){function t(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.cs=i,this.us=new qs,this.then=this.us.promise.then.bind(this.us.promise),this.us.promise.catch((function(t){}))}return t.hs=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.ls=setTimeout((function(){return e._s()}),t)},t.prototype.Vn=function(){return this._s()},t.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.us.reject(new Nr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype._s=function(){var t=this;this.rs.fs((function(){return null!==t.ls?(t.clearTimeout(),t.op().then((function(e){return t.us.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.ls&&(this.cs(this),clearTimeout(this.ls),this.ls=null)},t}(),eu=function(){function t(){var t=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new Fs(this,"async_queue_retry"),this.gs=function(){var e=Zs();e&&hr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Ps.gn()};var e=Zs();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.gs)}return Object.defineProperty(t.prototype,"Vs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),t.prototype.fs=function(t){this.enqueue(t)},t.prototype.ys=function(t){this.ps(),this.vs(t)},t.prototype.bs=function(){if(!this.Ts){this.Ts=!0;var t=Zs();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs)}},t.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise((function(t){})):this.vs(t)},t.prototype.Ss=function(t){var e=this;this.fs((function(){return e.ws.push(t),e.Ds()}))},t.prototype.Ds=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e=this;return Object(r.e)(this,(function(n){switch(n.label){case 0:if(0===this.ws.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return n.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!Qs(t=n.sent()))throw t;return hr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.ws.length>0&&this.Ps.An((function(){return e.Ds()})),n.label=5;case 5:return[2]}}))}))},t.prototype.vs=function(t){var e=this,n=this.ds.then((function(){return e.As=!0,t().catch((function(t){throw e.Is=t,e.As=!1,fr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.As=!1,t}))}));return this.ds=n,n},t.prototype.Pn=function(t,e,n){var r=this;this.ps(),this.Rs.indexOf(t)>-1&&(e=0);var i=tu.hs(this,t,e,n,(function(t){return r.Cs(t)}));return this.Es.push(i),i},t.prototype.ps=function(){this.Is&&dr()},t.prototype.Ns=function(){},t.prototype.xs=function(){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,t=this.ds];case 1:e.sent(),e.label=2;case 2:if(t!==this.ds)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Fs=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},t.prototype.Os=function(t){var e=this;return this.xs().then((function(){e.Es.sort((function(t,e){return t.os-e.os}));for(var n=0,r=e.Es;n<r.length;n++){var i=r[n];if(i.Vn(),"all"!==t&&i._n===t)break}return e.xs()}))},t.prototype.Ms=function(t){this.Rs.push(t)},t.prototype.Cs=function(t){var e=this.Es.indexOf(t);this.Es.splice(e,1)},t}();function nu(t,e){if(fr("AsyncQueue",e+": "+t),Qs(t))return new Nr(jr.UNAVAILABLE,e+": "+t);throw t}var ru=function(){this.ks=void 0,this.listeners=[]},iu=function(){this.queries=new Tr((function(t){return ws(t)}),ms),this.onlineState="Unknown",this.$s=new Set};function ou(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(n=yr(t),o=!1,(s=n.queries.get(i=e.query))||(o=!0,s=new ru),!o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),u=s,[4,n.Ls(i)];case 2:return u.ks=r.sent(),[3,4];case 3:return a=r.sent(),c=nu(a,"Initialization of query '"+_s(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(i,s),s.listeners.push(e),e.Bs(n.onlineState),s.ks&&e.qs(s.ks)&&cu(n),[2]}}))}))}function su(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u;return Object(r.e)(this,(function(r){return n=yr(t),o=!1,(s=n.queries.get(i=e.query))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),o?[2,(n.queries.delete(i),n.Us(i))]:[2]}))}))}function uu(t,e){for(var n=yr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.ks=s}}r&&cu(n)}function au(t,e,n){var r=yr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function cu(t){t.$s.forEach((function(t){t.next()}))}var hu=function(){function t(t,e,n){this.query=t,this.Qs=e,this.Ks=!1,this.Ws=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new pi(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Kt,!0)}var o=!1;return this.Ks?this.js(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.Ws=t,o},t.prototype.onError=function(t){this.Qs.error(t)},t.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.Ws&&!this.Ks&&this.Gs(this.Ws,t)&&(this.zs(this.Ws),e=!0),e},t.prototype.Gs=function(t,e){return!t.fromCache||!(this.options.Hs&&"Offline"!==e||t.docs.T()&&"Offline"!==e)},t.prototype.js=function(t){return t.docChanges.length>0||!!(t.Kt||this.Ws&&this.Ws.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.zs=function(t){t=pi.jt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.Qs.next(t)},t}(),fu=function(){function t(t){this.uid=t}return t.prototype.Js=function(){return null!=this.uid},t.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();fu.UNAUTHENTICATED=new fu(null),fu.Xs=new fu("google-credentials-uid"),fu.Zs=new fu("first-party-uid");var lu=function(t,e){this.user=e,this.type="OAuth",this.ti={},this.ti.Authorization="Bearer "+t},pu=function(){function t(){this.ei=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.ni=function(){},t.prototype.si=function(t){this.ei=t,t(fu.UNAUTHENTICATED)},t.prototype.ii=function(){this.ei=null},t}(),du=function(){function t(t){var e=this;this.ri=null,this.currentUser=fu.UNAUTHENTICATED,this.oi=!1,this.ai=0,this.ei=null,this.forceRefresh=!1,this.ri=function(){e.ai++,e.currentUser=e.ci(),e.oi=!0,e.ei&&e.ei(e.currentUser)},this.ai=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ri):(this.ri(null),t.get().then((function(t){e.auth=t,e.ri&&e.auth.addAuthTokenListener(e.ri)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.ai,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.ai!==e?(hr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(vr("string"==typeof n.accessToken),new lu(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.ni=function(){this.forceRefresh=!0},t.prototype.si=function(t){this.ei=t,this.oi&&t(this.currentUser)},t.prototype.ii=function(){this.auth&&this.auth.removeAuthTokenListener(this.ri),this.ri=null,this.ei=null},t.prototype.ci=function(){var t=this.auth&&this.auth.getUid();return vr(null===t||"string"==typeof t),new fu(t)},t}(),vu=function(){function t(t,e){this.ui=t,this.hi=e,this.type="FirstParty",this.user=fu.Zs}return Object.defineProperty(t.prototype,"ti",{get:function(){var t={"X-Goog-AuthUser":this.hi},e=this.ui.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),yu=function(){function t(t,e){this.ui=t,this.hi=e}return t.prototype.getToken=function(){return Promise.resolve(new vu(this.ui,this.hi))},t.prototype.si=function(t){t(fu.Zs)},t.prototype.ii=function(){},t.prototype.ni=function(){},t}(),gu=function(){function t(t,e,n,r){this.batchId=t,this.li=e,this.baseMutations=n,this.mutations=r}return t.prototype._i=function(t,e,n){for(var r=n.fi,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=qo(o,e,r[i]))}return e},t.prototype.di=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Fo(i,e,e,this.li))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Fo(a,e,o,this.li))}return e},t.prototype.wi=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.di(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ai())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&wr(this.mutations,t.mutations,(function(t,e){return Go(t,e)}))&&wr(this.baseMutations,t.baseMutations,(function(t,e){return Go(t,e)}))},t}(),bu=function(){function t(t,e,n,r){this.batch=t,this.Ti=e,this.fi=n,this.Ei=r}return t.from=function(e,n,r){vr(e.mutations.length===r.length);for(var i=si,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),mu=function(){function t(){this.Ii=new Tr((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.mi=!1}return t.prototype.Ai=function(t){var e=this.Ii.get(t);return e?e.readTime:Ar.min()},t.prototype.Ri=function(t,e){this.Pi(),this.Ii.set(t.key,{gi:t,readTime:e})},t.prototype.Vi=function(t,e){void 0===e&&(e=null),this.Pi(),this.Ii.set(t,{gi:null,readTime:e})},t.prototype.yi=function(t,e){this.Pi();var n=this.Ii.get(e);return void 0!==n?Bs.resolve(n.gi):this.pi(t,e)},t.prototype.getEntries=function(t,e){return this.vi(t,e)},t.prototype.apply=function(t){return this.Pi(),this.mi=!0,this.bi(t)},t.prototype.Pi=function(){},t}();function wu(t){return new Gi(t,!0)}function _u(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Iu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Eu=function(){function t(){this.Si=[]}return t.prototype.Di=function(t){this.Si.push(t)},t.prototype.Ci=function(){this.Si.forEach((function(t){return t()}))},t}(),Ou=function(){function t(t,e,n){this.Ni=t,this.xi=e,this.Fi=n}return t.prototype.Oi=function(t,e){var n=this;return this.xi.Mi(t,e).next((function(r){return n.ki(t,e,r)}))},t.prototype.ki=function(t,e,n){return this.Ni.yi(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].di(e,t);return t}))},t.prototype.$i=function(t,e,n){var r=ri();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].di(t,e);r=r.rt(t,e)})),r},t.prototype.Li=function(t,e){var n=this;return this.Ni.getEntries(t,e).next((function(e){return n.Bi(t,e)}))},t.prototype.Bi=function(t,e){var n=this;return this.xi.qi(t,e).next((function(r){var i=n.$i(t,e,r),o=ni();return i.forEach((function(t,e){e||(e=new is(t,Ar.min())),o=o.rt(t,e)})),o}))},t.prototype.Ui=function(t,e,n){return function(t){return Cr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Qi(t,e.path):ps(e)?this.Ki(t,e,n):this.Wi(t,e,n)},t.prototype.Qi=function(t,e){return this.Oi(t,new Cr(e)).next((function(t){var e=oi();return t instanceof rs&&(e=e.rt(t.key,t)),e}))},t.prototype.Ki=function(t,e,n){var r=this,i=e.collectionGroup,o=oi();return this.Fi.ji(t,i).next((function(s){return Bs.forEach(s,(function(s){var u=function(t,e){return new ss(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Wi(t,u,n).next((function(t){t.forEach((function(t,e){o=o.rt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Wi=function(t,e,n){var r,i,o=this;return this.Ni.Ui(t,e,n).next((function(n){return r=n,o.xi.Gi(t,e)})).next((function(e){return o.zi(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=Fo(a,h,h,o.li);r=f instanceof rs?r.rt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Is(e,n)||(r=r.remove(t))})),r}))},t.prototype.zi=function(t,e,n){for(var r=ai(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Qo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Ni.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof rs&&(c=c.rt(t,e))})),c}))},t}(),Tu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hi=n,this.Ji=r}return t.Yi=function(e,n){for(var r=ai(),i=ai(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ju=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.Xi=function(t){return n.Zi(t)},this.tr=function(t){return e.er(t)})}return t.prototype.Zi=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.tr&&this.tr(t),t},t}();function Nu(t,e){var n=t[1],r=e[1],i=mr(t[0],e[0]);return 0===i?mr(n,r):i}ju.nr=-1;var xu=function(){function t(t){this.sr=t,this.buffer=new Zr(Nu),this.ir=0}return t.prototype.rr=function(){return++this.ir},t.prototype.ar=function(t){var e=[t,this.rr()];if(this.buffer.size<this.sr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Nu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Au={cr:!1,ur:0,hr:0,lr:0},Su=function(){function t(t,e,n){this._r=t,this.dr=e,this.wr=n}return t.Tr=function(e){return new t(e,t.Er,t.Ir)},t}();Su.Er=10,Su.Ir=1e3,Su.mr=new Su(41943040,Su.Er,Su.Ir),Su.Ar=new Su(-1,0,0);var ku=function(){function t(t,e){this.Rr=t,this.rs=e,this.Pr=!1,this.gr=null}return t.prototype.start=function(t){-1!==this.Rr.params._r&&this.Vr(t)},t.prototype.stop=function(){this.gr&&(this.gr.cancel(),this.gr=null)},Object.defineProperty(t.prototype,"yr",{get:function(){return null!==this.gr},enumerable:!1,configurable:!0}),t.prototype.Vr=function(t){var e=this,n=this.Pr?3e5:6e4;hr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.gr=this.rs.Pn("lru_garbage_collection",n,(function(){return Object(r.b)(e,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:this.gr=null,this.Pr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.pr(this.Rr)];case 2:return n.sent(),[3,7];case 3:return Qs(e=n.sent())?(hr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ic(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Vr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Du=function(){function t(t,e){this.vr=t,this.params=e}return t.prototype.br=function(t,e){return this.vr.Sr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Dr=function(t,e){var n=this;if(0===e)return Bs.resolve(ju.nr);var r=new xu(e);return this.vr.De(t,(function(t){return r.ar(t.sequenceNumber)})).next((function(){return n.vr.Cr(t,(function(t){return r.ar(t)}))})).next((function(){return r.maxValue}))},t.prototype.Nr=function(t,e,n){return this.vr.Nr(t,e,n)},t.prototype.Fr=function(t,e){return this.vr.Fr(t,e)},t.prototype.Or=function(t,e){var n=this;return-1===this.params._r?(hr("LruGarbageCollector","Garbage collection skipped; disabled"),Bs.resolve(Au)):this.Mr(t).next((function(r){return r<n.params._r?(hr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params._r),Au):n.kr(t,e)}))},t.prototype.Mr=function(t){return this.vr.Mr(t)},t.prototype.kr=function(t,e){var n,r,i,s,u,a,c,h=this,f=Date.now();return this.br(t,this.params.dr).next((function(e){return e>h.params.wr?(hr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.wr+" from "+e),r=h.params.wr):r=e,s=Date.now(),h.Dr(t,r)})).next((function(r){return n=r,u=Date.now(),h.Nr(t,n,e)})).next((function(e){return i=e,a=Date.now(),h.Fr(t,n)})).next((function(t){return c=Date.now(),cr()<=o.a.DEBUG&&hr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+i+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Bs.resolve({cr:!0,ur:r,hr:i,lr:t})}))},t}();function Pu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Lu(e)),e=Cu(t.get(n),e);return Lu(e)}function Cu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Lu(t){return t+"\x01\x01"}function Vu(t){var e=t.length;if(vr(e>=2),2===e)return vr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),kr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&dr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:dr()}o=s+2}return new kr(r)}var Ru=function(t){this.$r=t};function Mu(t,e){if(e.document)return function(t,e,n){var r=to(t,e.name),i=Xi(e.updateTime),o=new Zo({mapValue:{fields:e.fields}});return new rs(r,i,o,{hasCommittedMutations:!!n})}(t.$r,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Cr.H(e.noDocument.path),r=Gu(e.noDocument.readTime);return new is(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Cr.H(e.unknownDocument.path),o=Gu(e.unknownDocument.version);return new os(i,o)}return dr()}function Uu(t,e,n){var r=qu(n),i=e.key.path.S().O();if(e instanceof rs){var o=function(t,e){return{name:Zi(t,e.key),fields:e.sn().mapValue.fields,updateTime:Hi(t,e.version.P())}}(t.$r,e);return new ya(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof is){var s=e.key.path.O(),u=Bu(e.version),a=e.hasCommittedMutations;return new ya(null,new da(s,u),null,a,r,i)}if(e instanceof os){var c=e.key.path.O(),h=Bu(e.version);return new ya(new va(c,h),null,null,!0,r,i)}return dr()}function qu(t){var e=t.P();return[e.seconds,e.nanoseconds]}function Fu(t){var e=new xr(t[0],t[1]);return Ar.m(e)}function Bu(t){var e=t.P();return new ca(e.seconds,e.nanoseconds)}function Gu(t){var e=new xr(t.seconds,t.nanoseconds);return Ar.m(e)}function zu(t,e){var n=(e.baseMutations||[]).map((function(e){return uo(t.$r,e)})),r=e.mutations.map((function(e){return uo(t.$r,e)})),i=xr.fromMillis(e.localWriteTimeMs);return new gu(e.batchId,i,n,r)}function Ku(t){var e,n,r=Gu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Gu(t.lastLimboFreeSnapshotVersion):Ar.min();return void 0!==t.query.documents?(vr(1===(n=t.query).documents.length),e=vs(as(no(n.documents[0])))):e=function(t){return vs(ho(t))}(t.query),new Qr(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Gr.fromBase64String(t.resumeToken))}function Qu(t,e){var n,r=Bu(e.et),i=Bu(e.lastLimboFreeSnapshotVersion);n=Br(e.target)?ao(t.$r,e.target):co(t.$r,e.target);var o=e.resumeToken.toBase64();return new ba(e.targetId,qr(e.target),r,o,e.sequenceNumber,i,n)}function Hu(t){var e=ho({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ys(e,e.limit,"L"):e}var Wu=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Fi=n,this.Lr=r,this.Br={}}return t.qr=function(e,n,r,i){return vr(""!==e.uid),new t(e.Js()?e.uid:"",n,r,i)},t.prototype.Ur=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ju(t).ns({index:la.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Qr=function(t,e,n,r){var i=this,o=$u(t),s=Ju(t);return s.add({}).next((function(u){vr("number"==typeof u);for(var a=new gu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return so(t.$r,e)})),i=n.mutations.map((function(e){return so(t.$r,e)}));return new la(e,n.batchId,n.li.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Zr((function(t,e){return mr(t.M(),e.M())})),l=0,p=r;l<p.length;l++){var d=p[l],v=pa.key(i.userId,d.key.path,u);f=f.add(d.key.path.S()),h.push(s.put(c)),h.push(o.put(v,pa.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Fi.Kr(t,e))})),t.Di((function(){i.Br[u]=a.keys()})),Bs.xn(h).next((function(){return a}))}))},t.prototype.Wr=function(t,e){var n=this;return Ju(t).get(e).next((function(t){return t?(vr(t.userId===n.userId),zu(n.serializer,t)):null}))},t.prototype.jr=function(t,e){var n=this;return this.Br[e]?Bs.resolve(this.Br[e]):this.Wr(t,e).next((function(t){if(t){var r=t.keys();return n.Br[e]=r,r}return null}))},t.prototype.Gr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ju(t).ns({index:la.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(vr(e.batchId>=r),o=zu(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.zr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ju(t).ns({index:la.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Hr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ju(t).Xn(la.userMutationsIndex,n).next((function(t){return t.map((function(t){return zu(e.serializer,t)}))}))},t.prototype.Mi=function(t,e){var n=this,r=pa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return $u(t).ns({range:i},(function(r,i,s){var u=r[0],a=r[2],c=Vu(r[1]);if(u===n.userId&&e.path.isEqual(c))return Ju(t).get(a).next((function(t){if(!t)throw dr();vr(t.userId===n.userId),o.push(zu(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.qi=function(t,e){var n=this,r=new Zr(mr),i=[];return e.forEach((function(e){var o=pa.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=$u(t).ns({range:s},(function(t,i,o){var s=t[0],u=t[2],a=Vu(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()}));i.push(u)})),Bs.xn(i).next((function(){return n.Jr(t,r)}))},t.prototype.Gi=function(t,e){var n=this,r=e.path,i=r.length+1,o=pa.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Zr(mr);return $u(t).ns({range:s},(function(t,e,o){var s=t[0],a=t[2],c=Vu(t[1]);s===n.userId&&r.N(c)?c.length===i&&(u=u.add(a)):o.done()})).next((function(){return n.Jr(t,u)}))},t.prototype.Jr=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ju(t).get(e).next((function(t){if(null===t)throw dr();vr(t.userId===n.userId),r.push(zu(n.serializer,t))})))})),Bs.xn(i).next((function(){return r}))},t.prototype.Yr=function(t,e){var n=this;return Xu(t.Xr,this.userId,e).next((function(r){return t.Di((function(){n.Zr(e.batchId)})),Bs.forEach(r,(function(e){return n.Lr.eo(t,e)}))}))},t.prototype.Zr=function(t){delete this.Br[t]},t.prototype.no=function(t){var e=this;return this.Ur(t).next((function(n){if(!n)return Bs.resolve();var r=IDBKeyRange.lowerBound(pa.prefixForUser(e.userId)),i=[];return $u(t).ns({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Vu(t[1]);i.push(o)}else r.done()})).next((function(){vr(0===i.length)}))}))},t.prototype.so=function(t,e){return Yu(t,this.userId,e)},t.prototype.io=function(t){var e=this;return Zu(t).get(this.userId).next((function(t){return t||new fa(e.userId,-1,"")}))},t}();function Yu(t,e,n){var r=pa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return $u(t).ns({range:o,es:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function Xu(t,e,n){var r=t.store(la.store),i=t.store(pa.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ns({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){vr(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=pa.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Bs.xn(o).next((function(){return c}))}function Ju(t){return Ua.qn(t,la.store)}function $u(t){return Ua.qn(t,pa.store)}function Zu(t){return Ua.qn(t,fa.store)}var ta=function(){function t(t,e){this.serializer=t,this.Fi=e}return t.prototype.Ri=function(t,e,n){return ra(t).put(ia(e),n)},t.prototype.Vi=function(t,e){var n=ra(t),r=ia(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.ro(t,r)}))},t.prototype.yi=function(t,e){var n=this;return ra(t).get(ia(e)).next((function(t){return n.oo(t)}))},t.prototype.ao=function(t,e){var n=this;return ra(t).get(ia(e)).next((function(t){var e=n.oo(t);return e?{gi:e,size:oa(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=ri();return this.co(t,e,(function(t,e){var i=n.oo(e);r=r.rt(t,i)})).next((function(){return r}))},t.prototype.uo=function(t,e){var n=this,r=ri(),i=new Xr(Cr.V);return this.co(t,e,(function(t,e){var o=n.oo(e);o?(r=r.rt(t,o),i=i.rt(t,oa(e))):(r=r.rt(t,null),i=i.rt(t,0))})).next((function(){return{ho:r,lo:i}}))},t.prototype.co=function(t,e,n){if(e.T())return Bs.resolve();var r=IDBKeyRange.bound(e.first().path.O(),e.last().path.O()),i=e.lt(),o=i.Et();return ra(t).ns({range:r},(function(t,e,r){for(var s=Cr.H(t);o&&Cr.V(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.O()):r.done()})).next((function(){for(;o;)n(o,null),o=i.It()?i.Et():null}))},t.prototype.Ui=function(t,e,n){var r=this,i=oi(),o=e.path.length+1,s={};if(n.isEqual(Ar.min())){var u=e.path.O();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.O(),c=qu(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=ya.collectionReadTimeIndex}return ra(t).ns(s,(function(t,n,s){if(t.length===o){var u=Mu(r.serializer,n);e.path.N(u.key.path)?u instanceof rs&&Is(e,u)&&(i=i.rt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype._o=function(t){return new ea(this,!!t&&t.fo)},t.prototype.wo=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return na(t).get(ga.key).next((function(t){return vr(!!t),t}))},t.prototype.ro=function(t,e){return na(t).put(ga.key,e)},t.prototype.oo=function(t){if(t){var e=Mu(this.serializer,t);return e instanceof is&&e.version.isEqual(Ar.min())?null:e}return null},t}(),ea=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).To=e,r.fo=n,r.Eo=new Tr((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(r.d)(e,t),e.prototype.bi=function(t){var e=this,n=[],r=0,i=new Zr((function(t,e){return mr(t.M(),e.M())}));return this.Ii.forEach((function(o,s){var u=e.Eo.get(o);if(s.gi){var a=Uu(e.To.serializer,s.gi,e.Ai(o));i=i.add(o.path.S());var c=oa(a);r+=c-u,n.push(e.To.Ri(t,o,a))}else if(r-=u,e.fo){var h=Uu(e.To.serializer,new is(o,Ar.min()),e.Ai(o));n.push(e.To.Ri(t,o,h))}else n.push(e.To.Vi(t,o))})),i.forEach((function(r){n.push(e.To.Fi.Kr(t,r))})),n.push(this.To.updateMetadata(t,r)),Bs.xn(n)},e.prototype.pi=function(t,e){var n=this;return this.To.ao(t,e).next((function(t){return null===t?(n.Eo.set(e,0),null):(n.Eo.set(e,t.size),t.gi)}))},e.prototype.vi=function(t,e){var n=this;return this.To.uo(t,e).next((function(t){var e=t.ho;return t.lo.forEach((function(t,e){n.Eo.set(t,e)})),e}))},e}(mu);function na(t){return Ua.qn(t,ga.store)}function ra(t){return Ua.qn(t,ya.store)}function ia(t){return t.path.O()}function oa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw dr();e=t.noDocument}return JSON.stringify(e).length}var sa=function(){function t(){this.Io=new ua}return t.prototype.Kr=function(t,e){return this.Io.add(e),Bs.resolve()},t.prototype.ji=function(t,e){return Bs.resolve(this.Io.getEntries(e))},t}(),ua=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.C(),n=t.S(),r=this.index[e]||new Zr(kr.V),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.C(),n=t.S(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Zr(kr.V)).O()},t}(),aa=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;vr(n<r&&n>=0&&r<=11);var o=new Hs("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ha.store)}(t),function(t){t.createObjectStore(fa.store,{keyPath:fa.keyPath}),t.createObjectStore(la.store,{keyPath:la.keyPath,autoIncrement:!0}).createIndex(la.userMutationsIndex,la.userMutationsKeyPath,{unique:!0}),t.createObjectStore(pa.store)}(t),Ia(t),function(t){t.createObjectStore(ya.store)}(t));var s=Bs.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ma.store),t.deleteObjectStore(ba.store),t.deleteObjectStore(wa.store)}(t),Ia(t)),s=s.next((function(){return function(t){var e=t.store(wa.store),n=new wa(0,0,Ar.min().P(),0);return e.put(wa.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(la.store).Xn().next((function(n){t.deleteObjectStore(la.store),t.createObjectStore(la.store,{keyPath:la.keyPath,autoIncrement:!0}).createIndex(la.userMutationsIndex,la.userMutationsKeyPath,{unique:!0});var r=e.store(la.store),i=n.map((function(t){return r.put(t)}));return Bs.xn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ea.store,{keyPath:Ea.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ga.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ya.store);e.createIndex(ya.readTimeIndex,ya.readTimeIndexPath,{unique:!1}),e.createIndex(ya.collectionReadTimeIndex,ya.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Oa.store,{keyPath:Oa.keyPath})}(t),function(t){t.createObjectStore(Ta.store,{keyPath:Ta.keyPath})}(t)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(ya.store).ns((function(t,n){e+=oa(n)})).next((function(){var n=new ga(e);return t.store(ga.store).put(ga.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(fa.store),r=t.store(la.store);return n.Xn().next((function(n){return Bs.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Xn(la.userMutationsIndex,i).next((function(r){return Bs.forEach(r,(function(r){vr(r.userId===n.userId);var i=zu(e.serializer,r);return Xu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ma.store),n=t.store(ya.store);return t.store(wa.store).get(wa.key).next((function(t){var r=[];return n.ns((function(n,i){var o=new kr(n),s=function(t){return[0,Pu(t)]}(o);r.push(e.get(s).next((function(n){return n?Bs.resolve():function(n){return e.put(new ma(0,Pu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Bs.xn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(_a.store,{keyPath:_a.keyPath});var n=e.store(_a.store),r=new ua,i=function(t){if(r.add(t)){var e=t.C(),i=t.S();return n.put({collectionId:e,parent:Pu(i)})}};return e.store(ya.store).ns({es:!0},(function(t,e){var n=new kr(t);return i(n.S())})).next((function(){return e.store(pa.store).ns({es:!0},(function(t,e){var n=Vu(t[1]);return i(n.S())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(ba.store);return n.ns((function(t,r){var i=Ku(r),o=Qu(e.serializer,i);return n.put(o)}))},t}(),ca=function(t,e){this.seconds=t,this.nanoseconds=e},ha=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ha.store="owner",ha.key="owner";var fa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};fa.store="mutationQueues",fa.keyPath="userId";var la=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};la.store="mutations",la.keyPath="batchId",la.userMutationsIndex="userMutationsIndex",la.userMutationsKeyPath=["userId","batchId"];var pa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Pu(e)]},t.key=function(t,e,n){return[t,Pu(e),n]},t}();pa.store="documentMutations",pa.PLACEHOLDER=new pa;var da=function(t,e){this.path=t,this.readTime=e},va=function(t,e){this.path=t,this.version=e},ya=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ya.store="remoteDocuments",ya.readTimeIndex="readTimeIndex",ya.readTimeIndexPath="readTime",ya.collectionReadTimeIndex="collectionReadTimeIndex",ya.collectionReadTimeIndexPath=["parentPath","readTime"];var ga=function(t){this.byteSize=t};ga.store="remoteDocumentGlobal",ga.key="remoteDocumentGlobalKey";var ba=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ba.store="targets",ba.keyPath="targetId",ba.queryTargetsIndexName="queryTargetsIndex",ba.queryTargetsKeyPath=["canonicalId","targetId"];var ma=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ma.store="targetDocuments",ma.keyPath=["targetId","path"],ma.documentTargetsIndex="documentTargetsIndex",ma.documentTargetsKeyPath=["path","targetId"];var wa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};wa.key="targetGlobalKey",wa.store="targetGlobal";var _a=function(t,e){this.collectionId=t,this.parent=e};function Ia(t){t.createObjectStore(ma.store,{keyPath:ma.keyPath}).createIndex(ma.documentTargetsIndex,ma.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ba.store,{keyPath:ba.keyPath}).createIndex(ba.queryTargetsIndexName,ba.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(wa.store)}_a.store="collectionParents",_a.keyPath=["collectionId","parent"];var Ea=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ea.store="clientMetadata",Ea.keyPath="clientId";var Oa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Oa.store="bundles",Oa.keyPath="bundleId";var Ta=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ta.store="namedQueries",Ta.keyPath="name";var ja=Object(r.h)(Object(r.h)(Object(r.h)(Object(r.h)([fa.store,la.store,pa.store,ya.store,ba.store,ha.store,wa.store,ma.store],[Ea.store]),[ga.store]),[_a.store]),[Oa.store,Ta.store]),Na=function(){function t(t){this.serializer=t}return t.prototype.mo=function(t,e){return xa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Gu(e.createTime),version:e.version};var e}))},t.prototype.Ao=function(t,e){return xa(t).put({bundleId:(n=e).id,createTime:Bu(Xi(n.createTime)),version:n.version});var n},t.prototype.Ro=function(t,e){return Aa(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Hu(e.bundledQuery),readTime:Gu(e.readTime)};var e}))},t.prototype.Po=function(t,e){return Aa(t).put(function(t){return{name:t.name,readTime:Bu(Xi(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function xa(t){return Ua.qn(t,Oa.store)}function Aa(t){return Ua.qn(t,Ta.store)}var Sa=function(){function t(){this.Vo=new ua}return t.prototype.Kr=function(t,e){var n=this;if(!this.Vo.has(e)){var r=e.C(),i=e.S();t.Di((function(){n.Vo.add(e)}));var o={collectionId:r,parent:Pu(i)};return ka(t).put(o)}return Bs.resolve()},t.prototype.ji=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[_r(e),""],!1,!0);return ka(t).Xn(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Vu(o.parent))}return n}))},t}();function ka(t){return Ua.qn(t,_a.store)}var Da=function(){function t(t){this.yo=t}return t.prototype.next=function(){return this.yo+=2,this.yo},t.po=function(){return new t(0)},t.vo=function(){return new t(-1)},t}(),Pa=function(){function t(t,e){this.Lr=t,this.serializer=e}return t.prototype.bo=function(t){var e=this;return this.So(t).next((function(n){var r=new Da(n.highestTargetId);return n.highestTargetId=r.next(),e.Do(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Co=function(t){return this.So(t).next((function(t){return Ar.m(new xr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.No=function(t){return this.So(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.xo=function(t,e,n){var r=this;return this.So(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.P()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Do(t,i)}))},t.prototype.Fo=function(t,e){var n=this;return this.Oo(t,e).next((function(){return n.So(t).next((function(r){return r.targetCount+=1,n.Mo(e,r),n.Do(t,r)}))}))},t.prototype.ko=function(t,e){return this.Oo(t,e)},t.prototype.$o=function(t,e){var n=this;return this.Lo(t,e.targetId).next((function(){return Ca(t).delete(e.targetId)})).next((function(){return n.So(t)})).next((function(e){return vr(e.targetCount>0),e.targetCount-=1,n.Do(t,e)}))},t.prototype.Nr=function(t,e,n){var r=this,i=0,o=[];return Ca(t).ns((function(s,u){var a=Ku(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.$o(t,a)))})).next((function(){return Bs.xn(o)})).next((function(){return i}))},t.prototype.De=function(t,e){return Ca(t).ns((function(t,n){var r=Ku(n);e(r)}))},t.prototype.So=function(t){return La(t).get(wa.key).next((function(t){return vr(null!==t),t}))},t.prototype.Do=function(t,e){return La(t).put(wa.key,e)},t.prototype.Oo=function(t,e){return Ca(t).put(Qu(this.serializer,e))},t.prototype.Mo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Bo=function(t){return this.So(t).next((function(t){return t.targetCount}))},t.prototype.qo=function(t,e){var n=qr(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ca(t).ns({range:r,index:ba.queryTargetsIndexName},(function(t,n,r){var o=Ku(n);Fr(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Uo=function(t,e,n){var r=this,i=[],o=Va(t);return e.forEach((function(e){var s=Pu(e.path);i.push(o.put(new ma(n,s))),i.push(r.Lr.Qo(t,n,e))})),Bs.xn(i)},t.prototype.Ko=function(t,e,n){var r=this,i=Va(t);return Bs.forEach(e,(function(e){var o=Pu(e.path);return Bs.xn([i.delete([n,o]),r.Lr.Wo(t,n,e)])}))},t.prototype.Lo=function(t,e){var n=Va(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.jo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Va(t),i=ai();return r.ns({range:n,es:!0},(function(t,e,n){var r=Vu(t[1]),o=new Cr(r);i=i.add(o)})).next((function(){return i}))},t.prototype.so=function(t,e){var n=Pu(e.path),r=IDBKeyRange.bound([n],[_r(n)],!1,!0),i=0;return Va(t).ns({index:ma.documentTargetsIndex,es:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.qe=function(t,e){return Ca(t).get(e).next((function(t){return t?Ku(t):null}))},t}();function Ca(t){return Ua.qn(t,ba.store)}function La(t){return Ua.qn(t,wa.store)}function Va(t){return Ua.qn(t,ma.store)}var Ra="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ma=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xr=e,r.Go=n,r}return Object(r.d)(e,t),e}(Eu),Ua=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ln=o,this.window=s,this.document=u,this.zo=c,this.Ho=h,this.Jo=null,this.Yo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Xo=null,this.inForeground=!1,this.Zo=null,this.ta=null,this.ea=Number.NEGATIVE_INFINITY,this.na=function(t){return Promise.resolve()},!t.kn())throw new Nr(jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Lr=new Ba(this,i),this.sa=n+"main",this.serializer=new Ru(a),this.ia=new Gs(this.sa,11,new aa(this.serializer)),this.ra=new Pa(this.Lr,this.serializer),this.Fi=new Sa,this.Ni=function(t,e){return new ta(t,e)}(this.serializer,this.Fi),this.oa=new Na(this.serializer),this.window&&this.window.localStorage?this.aa=this.window.localStorage:(this.aa=null,!1===h&&fr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.qn=function(t,e){if(t instanceof Ma)return Gs.qn(t.Xr,e);throw dr()},t.prototype.start=function(){var t=this;return this.ca().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Nr(jr.FAILED_PRECONDITION,Ra);return t.ua(),t.ha(),t.la(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.ra.No(e)}))})).then((function(e){t.Jo=new ju(e,t.zo)})).then((function(){t.Yo=!0})).catch((function(e){return t.ia&&t.ia.close(),Promise.reject(e)}))},t.prototype._a=function(t){var e=this;return this.na=function(n){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return this.yr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.fa=function(t){var e=this;this.ia.Kn((function(n){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.da=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs((function(){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return this.yr?[4,this.ca()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.ca=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Fa(e).put(new Ea(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.wa(e).next((function(e){e||(t.isPrimary=!1,t.ln.Ss((function(){return t.na(!1)})))}))})).next((function(){return t.Ta(e)})).next((function(n){return t.isPrimary&&!n?t.Ea(e).next((function(){return!1})):!!n&&t.Ia(e).next((function(){return!0}))}))})).catch((function(e){if(Qs(e))return hr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return hr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.ln.Ss((function(){return t.na(e)})),t.isPrimary=e}))},t.prototype.wa=function(t){var e=this;return qa(t).get(ha.key).next((function(t){return Bs.resolve(e.ma(t))}))},t.prototype.Aa=function(t){return Fa(t).delete(this.clientId)},t.prototype.Ra=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,n,i,o=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.Pa(this.ea,18e5)?[3,2]:(this.ea=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.qn(e,Ea.store);return n.Xn().next((function(t){var e=o.ga(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Bs.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=r.sent(),this.aa)for(n=0,i=e;n<i.length;n++)this.aa.removeItem(this.Va(i[n].clientId));r.label=2;case 2:return[2]}}))}))},t.prototype.la=function(){var t=this;this.ta=this.ln.Pn("client_metadata_refresh",4e3,(function(){return t.ca().then((function(){return t.Ra()})).then((function(){return t.la()}))}))},t.prototype.ma=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ta=function(t){var e=this;return this.Ho?Bs.resolve(!0):qa(t).get(ha.key).next((function(n){if(null!==n&&e.Pa(n.leaseTimestampMs,5e3)&&!e.ya(n.ownerId)){if(e.ma(n)&&e.networkEnabled)return!0;if(!e.ma(n)){if(!n.allowTabSynchronization)throw new Nr(jr.FAILED_PRECONDITION,Ra);return!1}}return!(!e.networkEnabled||!e.inForeground)||Fa(t).Xn().next((function(t){return void 0===e.ga(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&hr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.pa=function(){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.e)(this,(function(e){switch(e.label){case 0:return this.Yo=!1,this.va(),this.ta&&(this.ta.cancel(),this.ta=null),this.ba(),this.Sa(),[4,this.ia.runTransaction("shutdown","readwrite",[ha.store,Ea.store],(function(e){var n=new Ma(e,ju.nr);return t.Ea(n).next((function(){return t.Aa(n)}))}))];case 1:return e.sent(),this.ia.close(),this.Da(),[2]}}))}))},t.prototype.ga=function(t,e){var n=this;return t.filter((function(t){return n.Pa(t.updateTimeMs,e)&&!n.ya(t.clientId)}))},t.prototype.Ca=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Fa(e).Xn().next((function(e){return t.ga(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),t.prototype.Na=function(t){return Wu.qr(t,this.serializer,this.Fi,this.Lr)},t.prototype.xa=function(){return this.ra},t.prototype.Fa=function(){return this.Ni},t.prototype.Oa=function(){return this.Fi},t.prototype.Ma=function(){return this.oa},t.prototype.runTransaction=function(t,e,n){var r,i=this;return hr("IndexedDbPersistence","Starting transaction:",t),this.ia.runTransaction(t,"readonly"===e?"readonly":"readwrite",ja,(function(o){return r=new Ma(o,i.Jo?i.Jo.next():ju.nr),"readwrite-primary"===e?i.wa(r).next((function(t){return!!t||i.Ta(r)})).next((function(e){if(!e)throw fr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.ln.Ss((function(){return i.na(!1)})),new Nr(jr.FAILED_PRECONDITION,Iu);return n(r)})).next((function(t){return i.Ia(r).next((function(){return t}))})):i.ka(r).next((function(){return n(r)}))})).then((function(t){return r.Ci(),t}))},t.prototype.ka=function(t){var e=this;return qa(t).get(ha.key).next((function(t){if(null!==t&&e.Pa(t.leaseTimestampMs,5e3)&&!e.ya(t.ownerId)&&!e.ma(t)&&!(e.Ho||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Nr(jr.FAILED_PRECONDITION,Ra)}))},t.prototype.Ia=function(t){var e=new ha(this.clientId,this.allowTabSynchronization,Date.now());return qa(t).put(ha.key,e)},t.kn=function(){return Gs.kn()},t.prototype.Ea=function(t){var e=this,n=qa(t);return n.get(ha.key).next((function(t){return e.ma(t)?(hr("IndexedDbPersistence","Releasing primary lease."),n.delete(ha.key)):Bs.resolve()}))},t.prototype.Pa=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(fr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Zo=function(){t.ln.fs((function(){return t.inForeground="visible"===t.document.visibilityState,t.ca()}))},this.document.addEventListener("visibilitychange",this.Zo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.ba=function(){this.Zo&&(this.document.removeEventListener("visibilitychange",this.Zo),this.Zo=null)},t.prototype.ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Xo=function(){e.va(),e.ln.fs((function(){return e.pa()}))},this.window.addEventListener("unload",this.Xo))},t.prototype.Sa=function(){this.Xo&&(this.window.removeEventListener("unload",this.Xo),this.Xo=null)},t.prototype.ya=function(t){var e;try{var n=null!==(null===(e=this.aa)||void 0===e?void 0:e.getItem(this.Va(t)));return hr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return fr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.va=function(){if(this.aa)try{this.aa.setItem(this.Va(this.clientId),String(Date.now()))}catch(t){fr("Failed to set zombie client id.",t)}},t.prototype.Da=function(){if(this.aa)try{this.aa.removeItem(this.Va(this.clientId))}catch(t){}},t.prototype.Va=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function qa(t){return Ua.qn(t,ha.store)}function Fa(t){return Ua.qn(t,Ea.store)}var Ba=function(){function t(t,e){this.db=t,this.Rr=new Du(this,e)}return t.prototype.Sr=function(t){var e=this.$a(t);return this.db.xa().Bo(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.$a=function(t){var e=0;return this.Cr(t,(function(t){e++})).next((function(){return e}))},t.prototype.De=function(t,e){return this.db.xa().De(t,e)},t.prototype.Cr=function(t,e){return this.La(t,(function(t,n){return e(n)}))},t.prototype.Qo=function(t,e,n){return Ga(t,n)},t.prototype.Wo=function(t,e,n){return Ga(t,n)},t.prototype.Nr=function(t,e,n){return this.db.xa().Nr(t,e,n)},t.prototype.eo=function(t,e){return Ga(t,e)},t.prototype.Ba=function(t,e){return function(t,e){var n=!1;return Zu(t).ss((function(r){return Yu(t,r,e).next((function(t){return t&&(n=!0),Bs.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Fr=function(t,e){var n=this,r=this.db.Fa()._o(),i=[],o=0;return this.La(t,(function(s,u){if(u<=e){var a=n.Ba(t,s).next((function(e){if(!e)return o++,r.yi(t,s).next((function(){return r.Vi(s),Va(t).delete([0,Pu(s.path)])}))}));i.push(a)}})).next((function(){return Bs.xn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Go);return this.db.xa().ko(t,n)},t.prototype.qa=function(t,e){return Ga(t,e)},t.prototype.La=function(t,e){var n,r=Va(t),i=ju.nr;return r.ns({index:ma.documentTargetsIndex},(function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==ju.nr&&e(new Cr(Vu(n)),i),i=s,n=o):i=ju.nr})).next((function(){i!==ju.nr&&e(new Cr(Vu(n)),i)}))},t.prototype.Mr=function(t){return this.db.Fa().wo(t)},t}();function Ga(t,e){return Va(t).put(function(t,e){return new ma(0,Pu(t.path),e)}(e,t.Go))}function za(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ka=function(){function t(t,e,n,r){this.persistence=t,this.Ua=e,this.serializer=r,this.Qa=new Xr(mr),this.Ka=new Tr((function(t){return qr(t)}),Fr),this.Wa=Ar.min(),this.xi=t.Na(n),this.ja=t.Fa(),this.ra=t.xa(),this.Ga=new Ou(this.ja,this.xi,this.persistence.Oa()),this.oa=t.Ma(),this.Ua.za(this.Ga)}return t.prototype.pr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Or(n,e.Qa)}))},t}();function Qa(t,e,n,r){return new Ka(t,e,n,r)}function Ha(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=yr(t),i=n.xi,o=n.Ga,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var r;return n.xi.Hr(t).next((function(s){return r=s,i=n.persistence.Na(e),o=new Ou(n.ja,i,n.persistence.Oa()),i.Hr(t)})).next((function(e){for(var n=[],i=[],s=ai(),u=0,a=r;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];i.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return o.Li(t,s).next((function(t){return{Ha:t,Ja:n,Ya:i}}))}))}))];case 1:return s=r.sent(),[2,(n.xi=i,n.Ga=o,n.Ua.za(n.Ga),s)]}}))}))}function Wa(t,e){var n=yr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.ja._o({fo:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Bs.resolve();return o.forEach((function(t){s=s.next((function(){return r.yi(e,t)})).next((function(e){var o=e,s=n.Ei.get(t);vr(null!==s),(!o||o.version.A(s)<0)&&(o=i._i(t,o,n))&&r.Ri(o,n.Ti)}))})),s.next((function(){return t.xi.Yr(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.xi.no(t)})).next((function(){return n.Ga.Li(t,r)}))}))}function Ya(t){var e=yr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ra.Co(t)}))}function Xa(t,e){var n=yr(t),r=e.et,i=n.Qa;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.ja._o({fo:!0});i=n.Qa;var s=[];e.Gt.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.ra.Ko(t,e.ne,o).next((function(){return n.ra.Uo(t,e.te,o)})));var a=e.resumeToken;if(a.X()>0){var c=u.st(a,r).nt(t.Go);i=i.rt(o,c),function(t,e,n){return vr(e.resumeToken.X()>0),0===t.resumeToken.X()||e.et.R()-t.et.R()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(u,c,e)&&s.push(n.ra.ko(t,c))}}}));var u=ni();if(e.Ht.forEach((function(r,i){e.Jt.has(r)&&s.push(n.persistence.Lr.qa(t,r))})),s.push(function(t,e,n,r,i){var o=ai();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var i=ni();return n.forEach((function(n,o){var s=t.get(n),u=r;o instanceof is&&o.version.isEqual(Ar.min())?(e.Vi(n,u),i=i.rt(n,o)):null==s||o.version.A(s.version)>0||0===o.version.A(s.version)&&s.hasPendingWrites?(e.Ri(o,u),i=i.rt(n,o)):hr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),i}))}(t,o,e.Ht,r).next((function(t){u=t}))),!r.isEqual(Ar.min())){var a=n.ra.Co(t).next((function(e){return n.ra.xo(t,t.Go,r)}));s.push(a)}return Bs.xn(s).next((function(){return o.apply(t)})).next((function(){return n.Ga.Bi(t,u)}))})).then((function(t){return n.Qa=i,t}))}function Ja(t,e){var n=yr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.xi.Gr(t,e)}))}function $a(t,e){var n=yr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ra.qo(t,e).next((function(i){return i?Bs.resolve(r=i):n.ra.bo(t).next((function(i){return r=new Qr(e,i,0,t.Go),n.ra.Fo(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Qa.get(t.targetId);return(null===r||t.et.A(r.et)>0)&&(n.Qa=n.Qa.rt(t.targetId,t),n.Ka.set(e,t.targetId)),t}))}function Za(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:i=yr(t),o=i.Qa.get(e),s=n?"readwrite":"readwrite-primary",r.label=1;case 1:return r.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",s,(function(t){return i.persistence.Lr.removeTarget(t,o)}))];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:if(!Qs(u=r.sent()))throw u;return hr("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return i.Qa=i.Qa.remove(e),i.Ka.delete(o.target),[2]}}))}))}function tc(t,e,n){var r=yr(t),i=Ar.min(),o=ai();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=yr(t),i=r.Ka.get(n);return void 0!==i?Bs.resolve(r.Qa.get(i)):r.ra.qo(e,n)}(r,t,vs(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ra.jo(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Ua.Ui(t,e,n?i:Ar.min(),n?o:ai())})).next((function(t){return{documents:t,Xa:o}}))}))}function ec(t,e){var n=yr(t),r=yr(n.ra),i=n.Qa.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.qe(t,e).next((function(t){return t?t.target:null}))}))}function nc(t){var e=yr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=yr(t),i=ni(),o=qu(n),s=ra(e),u=IDBKeyRange.lowerBound(o,!0);return s.ns({index:ya.readTimeIndex,range:u},(function(t,e){var n=Mu(r.serializer,e);i=i.rt(n.key,n),o=e.readTime})).next((function(){return{Za:i,readTime:Fu(o)}}))}(e.ja,t,e.Wa)})).then((function(t){var n=t.Za;return e.Wa=t.readTime,n}))}function rc(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){return[2,(e=yr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=ra(t),n=Ar.min();return e.ns({index:ya.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Fu(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Wa=t}))]}))}))}function ic(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){if(t.code!==jr.FAILED_PRECONDITION||t.message!==Iu)throw t;return hr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var oc=function(){function t(t,e,n,r,i,o){this.ln=t,this.tc=n,this.ec=r,this.nc=i,this.listener=o,this.state=0,this.sc=0,this.ic=null,this.stream=null,this.Ps=new Fs(t,e)}return t.prototype.rc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.oc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.ac()},t.prototype.stop=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return this.rc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.cc=function(){this.state=0,this.Ps.reset()},t.prototype.uc=function(){var t=this;this.oc()&&null===this.ic&&(this.ic=this.ln.Pn(this.tc,6e4,(function(){return t.hc()})))},t.prototype.lc=function(t){this._c(),this.stream.send(t)},t.prototype.hc=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){return this.oc()?[2,this.close(0)]:[2]}))}))},t.prototype._c=function(){this.ic&&(this.ic.cancel(),this.ic=null)},t.prototype.close=function(t,e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){switch(n.label){case 0:return this._c(),this.Ps.cancel(),this.sc++,3!==t?this.Ps.reset():e&&e.code===jr.RESOURCE_EXHAUSTED?(fr(e.toString()),fr("Using maximum backoff delay to prevent overloading the backend."),this.Ps.mn()):e&&e.code===jr.UNAUTHENTICATED&&this.nc.ni(),null!==this.stream&&(this.fc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.dc(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.fc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.wc(this.sc),n=this.sc;this.nc.getToken().then((function(e){t.sc===n&&t.Tc(e)}),(function(n){e((function(){var e=new Nr(jr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Ec(e)}))}))},t.prototype.Tc=function(t){var e=this,n=this.wc(this.sc);this.stream=this.Ic(t),this.stream.mc((function(){n((function(){return e.state=2,e.listener.mc()}))})),this.stream.dc((function(t){n((function(){return e.Ec(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.ac=function(){var t=this;this.state=4,this.Ps.An((function(){return Object(r.b)(t,void 0,void 0,(function(){return Object(r.e)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Ec=function(t){return hr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.wc=function(t){var e=this;return function(n){e.ln.fs((function(){return e.sc===t?n():(hr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),sc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(r.d)(e,t),e.prototype.Ic=function(t){return this.ec.Ac("Listen",t)},e.prototype.onMessage=function(t){this.Ps.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:dr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(vr(void 0===e||"string"==typeof e),Gr.fromBase64String(e||"")):(vr(void 0===e||e instanceof Uint8Array),Gr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?jr.UNKNOWN:Yr(t.code);return new Nr(e,t.message||"")}(s);n=new bi(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=to(t,a.document.name),h=Xi(a.document.updateTime),f=new Zo({mapValue:{fields:a.document.fields}}),l=new rs(c,h,f,{});n=new yi(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=to(t,p.document),v=p.readTime?Xi(p.readTime):Ar.min(),y=new is(d,v);n=new yi([],p.removedTargetIds||[],y.key,y)}else if("documentRemove"in e){var g=e.documentRemove,b=to(t,g.document);n=new yi([],g.removedTargetIds||[],b,null)}else{if(!("filter"in e))return dr();var m=e.filter,w=new Hr(m.count||0);n=new gi(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ar.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ar.min():e.readTime?Xi(e.readTime):Ar.min()}(t);return this.listener.Rc(e,n)},e.prototype.Pc=function(t){var e={};e.database=ro(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Br(r)?{documents:ao(t,r)}:{query:co(t,r)}).targetId=e.targetId,e.resumeToken.X()>0?n.resumeToken=Wi(t,e.resumeToken):e.et.A(Ar.min())>0&&(n.readTime=Hi(t,e.et.P())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return dr()}}(0,e.tt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.lc(e)},e.prototype.gc=function(t){var e={};e.database=ro(this.serializer),e.removeTarget=t,this.lc(e)},e}(oc),uc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Vc=!1,s}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"yc",{get:function(){return this.Vc},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Vc=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.fc=function(){this.Vc&&this.vc([])},e.prototype.Ic=function(t){return this.ec.Ac("Write",t)},e.prototype.onMessage=function(t){if(vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vc){this.Ps.reset();var e=function(t,e){return t&&t.length>0?(vr(void 0!==e),t.map((function(t){return function(t,e){var n=Xi(t.updateTime?t.updateTime:e);n.isEqual(Ar.min())&&(n=Xi(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Vo(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Xi(t.commitTime);return this.listener.bc(n,e)}return vr(!t.writeResults||0===t.writeResults.length),this.Vc=!0,this.listener.Sc()},e.prototype.Dc=function(){var t={};t.database=ro(this.serializer),this.lc(t)},e.prototype.vc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return so(e.serializer,t)}))};this.lc(n)},e}(oc),ac=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.ec=n,i.serializer=r,i.Cc=!1,i}return Object(r.d)(e,t),e.prototype.Nc=function(){if(this.Cc)throw new Nr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.xc=function(t,e,n){var r=this;return this.Nc(),this.credentials.getToken().then((function(i){return r.ec.xc(t,e,n,i)})).catch((function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.ni(),t}))},e.prototype.Fc=function(t,e,n){var r=this;return this.Nc(),this.credentials.getToken().then((function(i){return r.ec.Fc(t,e,n,i)})).catch((function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.ni(),t}))},e.prototype.terminate=function(){this.Cc=!1},e}((function(){})),cc=function(){function t(t,e){this.rs=t,this.Oc=e,this.state="Unknown",this.Mc=0,this.kc=null,this.$c=!0}return t.prototype.Lc=function(){var t=this;0===this.Mc&&(this.Bc("Unknown"),this.kc=this.rs.Pn("online_state_timeout",1e4,(function(){return t.kc=null,t.qc("Backend didn't respond within 10 seconds."),t.Bc("Offline"),Promise.resolve()})))},t.prototype.Uc=function(t){"Online"===this.state?this.Bc("Unknown"):(this.Mc++,this.Mc>=1&&(this.Qc(),this.qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Bc("Offline")))},t.prototype.set=function(t){this.Qc(),this.Mc=0,"Online"===t&&(this.$c=!1),this.Bc(t)},t.prototype.Bc=function(t){t!==this.state&&(this.state=t,this.Oc(t))},t.prototype.qc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.$c?(fr(e),this.$c=!1):hr("OnlineStateTracker",e)},t.prototype.Qc=function(){null!==this.kc&&(this.kc.cancel(),this.kc=null)},t}(),hc=function(t,e,n,i,o){var s=this;this.Kc=t,this.Wc=e,this.rs=n,this.jc={},this.Gc=[],this.zc=new Map,this.Hc=new Set,this.Jc=[],this.Yc=o,this.Yc.Xc((function(t){n.fs((function(){return Object(r.b)(s,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return mc(this)?(hr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:return(e=yr(t)).Hc.add(4),[4,lc(e)];case 1:return n.sent(),e.Zc.set("Unknown"),e.Hc.delete(4),[4,fc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Zc=new cc(n,i)};function fc(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!mc(t))return[3,4];e=0,n=t.Jc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function lc(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:e=0,n=t.Jc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function pc(t,e){var n=yr(t);n.zc.has(e.targetId)||(n.zc.set(e.targetId,e),bc(n)?gc(n):Cc(n).oc()&&vc(n,e))}function dc(t,e){var n=yr(t),r=Cc(n);n.zc.delete(e),r.oc()&&yc(n,e),0===n.zc.size&&(r.oc()?r.uc():mc(n)&&n.Zc.set("Unknown"))}function vc(t,e){t.tu.Ie(e.targetId),Cc(t).Pc(e)}function yc(t,e){t.tu.Ie(e),Cc(t).gc(e)}function gc(t){t.tu=new wi({Be:function(e){return t.jc.Be(e)},qe:function(e){return t.zc.get(e)||null}}),Cc(t).start(),t.Zc.Lc()}function bc(t){return mc(t)&&!Cc(t).rc()&&t.zc.size>0}function mc(t){return 0===yr(t).Hc.size}function wc(t){t.tu=void 0}function _c(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return t.zc.forEach((function(e,n){vc(t,e)})),[2]}))}))}function Ic(t,e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){return wc(t),bc(t)?(t.Zc.Uc(e),gc(t)):t.Zc.set("Unknown"),[2]}))}))}function Ec(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(u){switch(u.label){case 0:if(t.Zc.set("Online"),!(e instanceof bi&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:n=e.cause,i=0,o=e.targetIds,r.label=1;case 1:return i<o.length?t.zc.has(s=o[i])?[4,t.jc.eu(s,n)]:[3,3]:[3,5];case 2:r.sent(),t.zc.delete(s),t.tu.removeTarget(s),r.label=3;case 3:r.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return i=u.sent(),hr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),[4,Oc(t,i)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof yi?t.tu.pe(e):e instanceof gi?t.tu.Fe(e):t.tu.Se(e),n.isEqual(Ar.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Ya(t.Kc)];case 8:return o=u.sent(),n.A(o)>=0?[4,function(t,e){var n=t.tu.ke(e);return n.Gt.forEach((function(n,r){if(n.resumeToken.X()>0){var i=t.zc.get(r);i&&t.zc.set(r,i.st(n.resumeToken,e))}})),n.zt.forEach((function(e){var n=t.zc.get(e);if(n){t.zc.set(e,n.st(Gr.Z,n.et)),yc(t,e);var r=new Qr(n.target,e,1,n.sequenceNumber);vc(t,r)}})),t.jc.nu(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return hr("RemoteStore","Failed to raise snapshot:",s=u.sent()),[4,Oc(t,s)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Oc(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i=this;return Object(r.e)(this,(function(o){switch(o.label){case 0:if(!Qs(e))throw e;return t.Hc.add(1),[4,lc(t)];case 1:return o.sent(),t.Zc.set("Offline"),n||(n=function(){return Ya(t.Kc)}),t.rs.Ss((function(){return Object(r.b)(i,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return hr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Hc.delete(1),[4,fc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Tc(t,e){return e().catch((function(n){return Oc(t,n,e)}))}function jc(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:e=yr(t),n=Lc(e),i=e.Gc.length>0?e.Gc[e.Gc.length-1].batchId:-1,r.label=1;case 1:if(!function(t){return mc(t)&&t.Gc.length<10}(e))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,Ja(e.Kc,i)];case 3:return null===(o=r.sent())?(0===e.Gc.length&&n.uc(),[3,7]):(i=o.batchId,function(t,e){t.Gc.push(e);var n=Lc(t);n.oc()&&n.yc&&n.vc(e.mutations)}(e,o),[3,6]);case 4:return s=r.sent(),[4,Oc(e,s)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return Nc(e)&&xc(e),[2]}}))}))}function Nc(t){return mc(t)&&!Lc(t).rc()&&t.Gc.length>0}function xc(t){Lc(t).start()}function Ac(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return Lc(t).Dc(),[2]}))}))}function Sc(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n,i;return Object(r.e)(this,(function(r){for(e=Lc(t),n=0,i=t.Gc;n<i.length;n++)e.vc(i[n].mutations);return[2]}))}))}function kc(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return i=t.Gc.shift(),o=bu.from(i,e,n),[4,Tc(t,(function(){return t.jc.su(o)}))];case 1:return r.sent(),[4,jc(t)];case 2:return r.sent(),[2]}}))}))}function Dc(t,e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){switch(n.label){case 0:return e&&Lc(t).yc?[4,function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return Wr(i=e.code)&&i!==jr.ABORTED?(n=t.Gc.shift(),Lc(t).cc(),[4,Tc(t,(function(){return t.jc.iu(n.batchId,e)}))]):[3,3];case 1:return r.sent(),[4,jc(t)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Nc(t)&&xc(t),[2]}}))}))}function Pc(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=yr(t),e?(n.Hc.delete(2),[4,fc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Hc.add(2),[4,lc(n)]);case 3:r.sent(),n.Zc.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Cc(t){var e=this;return t.ru||(t.ru=function(t,e,n){var r=yr(t);return r.Nc(),new sc(e,r.ec,r.credentials,r.serializer,n)}(t.Wc,t.rs,{mc:_c.bind(null,t),dc:Ic.bind(null,t),Rc:Ec.bind(null,t)}),t.Jc.push((function(n){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return n?(t.ru.cc(),bc(t)?gc(t):t.Zc.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ru.stop()];case 2:e.sent(),wc(t),e.label=3;case 3:return[2]}}))}))}))),t.ru}function Lc(t){var e=this;return t.ou||(t.ou=function(t,e,n){var r=yr(t);return r.Nc(),new uc(e,r.ec,r.credentials,r.serializer,n)}(t.Wc,t.rs,{mc:Ac.bind(null,t),dc:Dc.bind(null,t),Sc:Sc.bind(null,t),bc:kc.bind(null,t)}),t.Jc.push((function(n){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return n?(t.ou.cc(),[4,jc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.ou.stop()];case 3:e.sent(),t.Gc.length>0&&(hr("RemoteStore","Stopping write stream with "+t.Gc.length+" pending writes"),t.Gc=[]),e.label=4;case 4:return[2]}}))}))}))),t.ou}var Vc=function(){function t(){this.au=new Zr(Rc.cu),this.uu=new Zr(Rc.hu)}return t.prototype.T=function(){return this.au.T()},t.prototype.Qo=function(t,e){var n=new Rc(t,e);this.au=this.au.add(n),this.uu=this.uu.add(n)},t.prototype.lu=function(t,e){var n=this;t.forEach((function(t){return n.Qo(t,e)}))},t.prototype.Wo=function(t,e){this._u(new Rc(t,e))},t.prototype.fu=function(t,e){var n=this;t.forEach((function(t){return n.Wo(t,e)}))},t.prototype.du=function(t){var e=this,n=new Cr(new kr([])),r=new Rc(n,t),i=new Rc(n,t+1),o=[];return this.uu.Nt([r,i],(function(t){e._u(t),o.push(t.key)})),o},t.prototype.wu=function(){var t=this;this.au.forEach((function(e){return t._u(e)}))},t.prototype._u=function(t){this.au=this.au.delete(t),this.uu=this.uu.delete(t)},t.prototype.Tu=function(t){var e=new Cr(new kr([])),n=new Rc(e,t),r=new Rc(e,t+1),i=ai();return this.uu.Nt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.so=function(t){var e=new Rc(t,0),n=this.au.Ft(e);return null!==n&&t.isEqual(n.key)},t}(),Rc=function(){function t(t,e){this.key=t,this.Eu=e}return t.cu=function(t,e){return Cr.V(t.key,e.key)||mr(t.Eu,e.Eu)},t.hu=function(t,e){return mr(t.Eu,e.Eu)||Cr.V(t.key,e.key)},t}();function Mc(t,e){return"firestore_clients_"+t+"_"+e}function Uc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Js()&&(r+="_"+e.uid),r}function qc(t,e){return"firestore_targets_"+t+"_"+e}var Fc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Iu=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Nr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(fr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Iu=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Nr(r.error.code,r.error.message)),i?new t(e,r.state,o):(fr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.mu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Gc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Iu=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=hi(),s=0;i&&s<r.activeTargetIds.length;++s)i=Rr(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(fr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),zc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Iu=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(fr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Kc=function(){function t(){this.activeTargetIds=hi()}return t.prototype.Au=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ru=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.mu=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Qc=function(){function t(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.Pu=r,this.gu=null,this.Oc=null,this.Xi=null,this.Vu=this.yu.bind(this),this.pu=new Xr(mr),this.yr=!1,this.vu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.bu=Mc(this.persistenceKey,this.Pu),this.Su=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pu=this.pu.rt(this.Pu,new Kc),this.Du=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Cu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Nu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xu=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fu=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Vu)}return t.kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e,n,i,o,s,u,a,c,h,f=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.gu.Ca()];case 1:for(t=r.sent(),e=0,n=t;e<n.length;e++)(i=n[e])!==this.Pu&&(o=this.getItem(Mc(this.persistenceKey,i)))&&(s=Gc.Iu(i,o))&&(this.pu=this.pu.rt(s.clientId,s));for(this.Ou(),(u=this.storage.getItem(this.xu))&&(a=this.Mu(u))&&this.ku(a),c=0,h=this.vu;c<h.length;c++)this.yu(h[c]);return this.vu=[],this.window.addEventListener("unload",(function(){return f.pa()})),this.yr=!0,[2]}}))}))},t.prototype.er=function(t){this.setItem(this.Su,JSON.stringify(t))},t.prototype.$u=function(){return this.Lu(this.pu)},t.prototype.Bu=function(t){var e=!1;return this.pu.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.qu=function(t){this.Uu(t,"pending")},t.prototype.Qu=function(t,e,n){this.Uu(t,e,n),this.Ku(t)},t.prototype.Wu=function(t){var e="not-current";if(this.Bu(t)){var n=this.storage.getItem(qc(this.persistenceKey,t));if(n){var r=Bc.Iu(t,n);r&&(e=r.state)}}return this.ju.Au(t),this.Ou(),e},t.prototype.Gu=function(t){this.ju.Ru(t),this.Ou()},t.prototype.zu=function(t){return this.ju.activeTargetIds.has(t)},t.prototype.Hu=function(t){this.removeItem(qc(this.persistenceKey,t))},t.prototype.Ju=function(t,e,n){this.Yu(t,e,n)},t.prototype.Xu=function(t,e,n){var r=this;e.forEach((function(t){r.Ku(t)})),this.currentUser=t,n.forEach((function(t){r.qu(t)}))},t.prototype.Zu=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.pa=function(){this.yr&&(this.window.removeEventListener("storage",this.Vu),this.removeItem(this.bu),this.yr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return hr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){hr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){hr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.yu=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(hr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.bu)return void fr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss((function(){return Object(r.b)(e,void 0,void 0,(function(){var t,e,i,o,s,u;return Object(r.e)(this,(function(r){if(this.yr){if(null!==n.key)if(this.Du.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Cu.test(n.key)){if(null!==n.newValue&&(i=this.oh(n.key,n.newValue)))return[2,this.ah(i)]}else if(this.Nu.test(n.key)){if(null!==n.newValue&&(o=this.uh(n.key,n.newValue)))return[2,this.hh(o)]}else if(n.key===this.xu){if(null!==n.newValue&&(s=this.Mu(n.newValue)))return[2,this.ku(s)]}else if(n.key===this.Su)(u=function(t){var e=ju.nr;if(null!=t)try{var n=JSON.parse(t);vr("number"==typeof n),e=n}catch(t){fr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ju.nr&&this.Xi(u);else if(n.key===this.Fu)return[2,this.gu.lh()]}else this.vu.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"ju",{get:function(){return this.pu.get(this.Pu)},enumerable:!1,configurable:!0}),t.prototype.Ou=function(){this.setItem(this.bu,this.ju.mu())},t.prototype.Uu=function(t,e,n){var r=new Fc(this.currentUser,t,e,n),i=Uc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.mu())},t.prototype.Ku=function(t){var e=Uc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xu,JSON.stringify({clientId:this.Pu,onlineState:t}))},t.prototype.Yu=function(t,e,n){var r=qc(this.persistenceKey,t),i=new Bc(t,e,n);this.setItem(r,i.mu())},t.prototype.nh=function(){this.setItem(this.Fu,"value-not-used")},t.prototype.sh=function(t){var e=this.Du.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return Gc.Iu(n,e)},t.prototype.oh=function(t,e){var n=this.Cu.exec(t),r=Number(n[1]);return Fc.Iu(new fu(void 0!==n[2]?n[2]:null),r,e)},t.prototype.uh=function(t,e){var n=this.Nu.exec(t),r=Number(n[1]);return Bc.Iu(r,e)},t.prototype.Mu=function(t){return zc.Iu(t)},t.prototype.ah=function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.gu._h(t.batchId,t.state,t.error)]:(hr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.hh=function(t){return this.gu.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pu.rt(t,e):this.pu.remove(t),i=this.Lu(this.pu),o=this.Lu(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.gu.dh(s,u).then((function(){n.pu=r}))},t.prototype.ku=function(t){this.pu.get(t.clientId)&&this.Oc(t.onlineState)},t.prototype.Lu=function(t){var e=hi();return t.forEach((function(t,n){e=e.Ot(n.activeTargetIds)})),e},t}(),Hc=function(){function t(){this.wh=new Kc,this.Th={},this.Oc=null,this.Xi=null}return t.prototype.qu=function(t){},t.prototype.Qu=function(t,e,n){},t.prototype.Wu=function(t){return this.wh.Au(t),this.Th[t]||"not-current"},t.prototype.Ju=function(t,e,n){this.Th[t]=e},t.prototype.Gu=function(t){this.wh.Ru(t)},t.prototype.zu=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Hu=function(t){delete this.Th[t]},t.prototype.$u=function(){return this.wh.activeTargetIds},t.prototype.Bu=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new Kc,Promise.resolve()},t.prototype.Xu=function(t,e,n){},t.prototype.Zu=function(t){},t.prototype.pa=function(){},t.prototype.er=function(t){},t.prototype.eh=function(){},t}(),Wc=function(t){this.key=t},Yc=function(t){this.key=t},Xc=function(){function t(t,e){this.query=t,this.Eh=e,this.Ih=null,this.Zt=!1,this.mh=ai(),this.Qt=ai(),this.Ah=Es(t),this.Rh=new fi(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.Vh:new li,i=e?e.Rh:this.Rh,o=e?e.Qt:this.Qt,s=i,u=!1,a=cs(this.query)&&i.size===this.query.limit?i.last():null,c=hs(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var h=i.get(t),f=e instanceof rs?e:null;f&&(f=Is(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Je||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.yh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),cs(this.query)||hs(this.query))for(;s.size>this.query.limit;){var h=cs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,Vh:r,ph:u,Qt:o}},t.prototype.yh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},t.prototype.bi=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.Qt=t.Qt;var o=t.Vh.qt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dr()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)})),this.bh(n);var s=e?this.Sh():[],u=0===this.mh.size&&this.Zt?1:0,a=u!==this.Ih;return this.Ih=u,0!==o.length||a?{snapshot:new pi(this.query,t.Rh,i,o,t.Qt,0===u,a,!1),Dh:s}:{Dh:s}},t.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.bi({Rh:this.Rh,Vh:new li,Qt:this.Qt,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Eh.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).Je},t.prototype.bh=function(t){var e=this;t&&(t.te.forEach((function(t){return e.Eh=e.Eh.add(t)})),t.ee.forEach((function(t){})),t.ne.forEach((function(t){return e.Eh=e.Eh.delete(t)})),this.Zt=t.Zt)},t.prototype.Sh=function(){var t=this;if(!this.Zt)return[];var e=this.mh;this.mh=ai(),this.Rh.forEach((function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))}));var n=[];return e.forEach((function(e){t.mh.has(e)||n.push(new Yc(e))})),this.mh.forEach((function(t){e.has(t)||n.push(new Wc(t))})),n},t.prototype.Nh=function(t){this.Eh=t.Xa,this.mh=ai();var e=this.gh(t.documents);return this.bi(e,!0)},t.prototype.xh=function(){return pi.jt(this.query,this.Rh,this.Qt,0===this.Ih)},t}(),Jc=function(t,e,n){this.query=t,this.targetId=e,this.view=n},$c=function(t){this.key=t,this.Fh=!1},Zc=function(){function t(t,e,n,r,i,o){this.Kc=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Tr((function(t){return ws(t)}),ms),this.qh=new Map,this.Uh=[],this.Qh=new Xr(Cr.V),this.Kh=new Map,this.Wh=new Vc,this.jh={},this.Gh=new Map,this.zh=Da.vo(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function th(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=Ah(t),(o=n.Bh.get(e))?(n.kh.Wu(o.targetId),i=o.view.xh(),[3,4]):[3,1];case 1:return[4,$a(n.Kc,vs(e))];case 2:return s=r.sent(),u=n.kh.Wu(s.targetId),[4,eh(n,e,s.targetId,"current"===u)];case 3:i=r.sent(),n.Jh&&pc(n.Oh,s),r.label=4;case 4:return[2,i]}}))}))}function eh(t,e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s,u,a,c,h;return Object(r.e)(this,(function(f){switch(f.label){case 0:return t.Yh=function(e,n,i){return function(t,e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(o=e.view.gh(n)).ph?[4,tc(t.Kc,e.query,!1).then((function(t){return e.view.gh(t.documents,o)}))]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return s=i&&i.Gt.get(e.targetId),u=e.view.bi(o,t.Jh,s),[2,(dh(t,e.targetId,u.Dh),u.snapshot)]}}))}))}(t,e,n,i)},[4,tc(t.Kc,e,!0)];case 1:return o=f.sent(),s=new Xc(e,o.Xa),u=s.gh(o.documents),a=vi.Xt(n,i&&"Offline"!==t.onlineState),c=s.bi(u,t.Jh,a),dh(t,n,c.Dh),h=new Jc(e,n,s),[2,(t.Bh.set(e,h),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),c.snapshot)]}}))}))}function nh(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=yr(t),i=n.Bh.get(e),(o=n.qh.get(i.targetId)).length>1?[2,(n.qh.set(i.targetId,o.filter((function(t){return!ms(t,e)}))),void n.Bh.delete(e))]:n.Jh?(n.kh.Gu(i.targetId),n.kh.Bu(i.targetId)?[3,2]:[4,Za(n.Kc,i.targetId,!1).then((function(){n.kh.Hu(i.targetId),dc(n.Oh,i.targetId),lh(n,i.targetId)})).catch(ic)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return lh(n,i.targetId),[4,Za(n.Kc,i.targetId,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}function rh(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:i=Sh(t),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,function(t,e){var n,r=yr(t),i=xr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ai());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Ga.Li(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Bo(c,n.get(c.key));null!=h&&s.push(new Qo(c.key,h,es(h.proto.mapValue),Ro.exists(!0)))}return r.xi.Qr(t,i,s,e)}))})).then((function(t){var e=t.wi(n);return{batchId:t.batchId,Ii:e}}))}(i.Kc,e)];case 2:return o=r.sent(),i.kh.qu(o.batchId),function(t,e,n){var r=t.jh[t.currentUser.Ys()];r||(r=new Xr(mr)),r=r.rt(e,n),t.jh[t.currentUser.Ys()]=r}(i,o.batchId,n),[4,gh(i,o.Ii)];case 3:return r.sent(),[4,jc(i.Oh)];case 4:return r.sent(),[3,6];case 5:return s=r.sent(),u=nu(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}function ih(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:n=yr(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,Xa(n.Kc,e)];case 2:return i=r.sent(),e.Gt.forEach((function(t,e){var r=n.Kh.get(e);r&&(vr(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?r.Fh=!0:t.ee.size>0?vr(r.Fh):t.ne.size>0&&(vr(r.Fh),r.Fh=!1))})),[4,gh(n,i,e)];case 3:return r.sent(),[3,6];case 4:return[4,ic(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function oh(t,e,n){var r=yr(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach((function(t,n){var r=n.view.Bs(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=yr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Bs(e)&&(r=!0)})),r&&cu(n)}(r.Mh,e),i.length&&r.Lh.Rc(i),r.onlineState=e,r.Jh&&r.kh.Zu(e)}}function sh(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(i=yr(t)).kh.Ju(e,"rejected",n),o=i.Kh.get(e),(s=o&&o.key)?(u=(u=new Xr(Cr.V)).rt(s,new is(s,Ar.min())),a=ai().add(s),c=new di(Ar.min(),new Map,new Zr(mr),u,a),[4,ih(i,c)]):[3,2];case 1:return r.sent(),i.Qh=i.Qh.remove(s),i.Kh.delete(e),yh(i),[3,4];case 2:return[4,Za(i.Kc,e,!1).then((function(){return lh(i,e,n)})).catch(ic)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}function uh(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:n=yr(t),i=e.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,Wa(n.Kc,e)];case 2:return o=r.sent(),fh(n,i,null),hh(n,i),n.kh.Qu(i,"acknowledged"),[4,gh(n,o)];case 3:return r.sent(),[3,6];case 4:return[4,ic(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function ah(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:i=yr(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=yr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.xi.Wr(t,e).next((function(e){return vr(null!==e),r=e.keys(),n.xi.Yr(t,e)})).next((function(){return n.xi.no(t)})).next((function(){return n.Ga.Li(t,r)}))}))}(i.Kc,e)];case 2:return o=r.sent(),fh(i,e,n),hh(i,e),i.kh.Qu(e,"rejected",n),[4,gh(i,o)];case 3:return r.sent(),[3,6];case 4:return[4,ic(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function ch(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:mc((n=yr(t)).Oh)||hr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,function(t){var e=yr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.xi.zr(t)}))}(n.Kc)];case 2:return-1===(i=r.sent())?[2,void e.resolve()]:((o=n.Gh.get(i)||[]).push(e),n.Gh.set(i,o),[3,4]);case 3:return s=r.sent(),u=nu(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}function hh(t,e){(t.Gh.get(e)||[]).forEach((function(t){t.resolve()})),t.Gh.delete(e)}function fh(t,e,n){var r=yr(t),i=r.jh[r.currentUser.Ys()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.Ys()]=i}}function lh(t,e,n){void 0===n&&(n=null),t.kh.Gu(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.du(e).forEach((function(e){t.Wh.so(e)||ph(t,e)}))}function ph(t,e){var n=t.Qh.get(e);null!==n&&(dc(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),yh(t))}function dh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Wc?(t.Wh.Qo(o.key,e),vh(t,o)):o instanceof Yc?(hr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.Wo(o.key,e),t.Wh.so(o.key)||ph(t,o.key)):dr()}}function vh(t,e){var n=e.key;t.Qh.get(n)||(hr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),yh(t))}function yh(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new $c(e)),t.Qh=t.Qh.rt(e,n),pc(t.Oh,new Qr(vs(as(e.path)),n,2,ju.nr))}}function gh(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u;return Object(r.e)(this,(function(a){switch(a.label){case 0:return i=yr(t),o=[],s=[],u=[],i.Bh.T()?[3,3]:(i.Bh.forEach((function(t,r){u.push(i.Yh(r,e,n).then((function(t){if(t){i.Jh&&i.kh.Ju(r.targetId,t.fromCache?"not-current":"current"),o.push(t);var e=Tu.Yi(r.targetId,t);s.push(e)}})))})),[4,Promise.all(u)]);case 1:return a.sent(),i.Lh.Rc(o),[4,function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h;return Object(r.e)(this,(function(r){switch(r.label){case 0:n=yr(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Bs.forEach(e,(function(e){return Bs.forEach(e.Hi,(function(r){return n.persistence.Lr.Qo(t,e.targetId,r)})).next((function(){return Bs.forEach(e.Ji,(function(r){return n.persistence.Lr.Wo(t,e.targetId,r)}))}))}))}))];case 2:return r.sent(),[3,4];case 3:if(!Qs(i=r.sent()))throw i;return hr("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,s=e;o<s.length;o++)a=(u=s[o]).targetId,u.fromCache||(c=n.Qa.get(a),h=c.it(c.et),n.Qa=n.Qa.rt(a,h));return[2]}}))}))}(i.Kc,s)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function bh(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(n=yr(t)).currentUser.isEqual(e)?[3,3]:(hr("SyncEngine","User change. New user:",e.Ys()),[4,Ha(n.Kc,e)]);case 1:return i=r.sent(),n.currentUser=e,function(t,e){t.Gh.forEach((function(t){t.forEach((function(t){t.reject(new Nr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Gh.clear()}(n),n.kh.Xu(e,i.Ja,i.Ya),[4,gh(n,i.Ha)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}function mh(t,e){var n=yr(t),r=n.Kh.get(e);if(r&&r.Fh)return ai().add(r.key);var i=ai(),o=n.qh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Bh.get(u[s]);i=i.Ot(a.view.Ph)}return i}function wh(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,tc((n=yr(t)).Kc,e.query,!0)];case 1:return i=r.sent(),o=e.view.Nh(i),[2,(n.Jh&&dh(n,e.targetId,o.Dh),o)]}}))}))}function _h(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){return[2,nc((e=yr(t)).Kc).then((function(t){return gh(e,t)}))]}))}))}function Ih(t,e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,function(t,e){var n=yr(t),r=yr(n.xi);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jr(t,e).next((function(e){return e?n.Ga.Li(t,e):Bs.resolve(null)}))}))}((o=yr(t)).Kc,e)];case 1:return null===(s=r.sent())?[3,6]:"pending"!==n?[3,3]:[4,jc(o.Oh)];case 2:return r.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(fh(o,e,i||null),hh(o,e),function(t,e){yr(yr(t).xi).Zr(e)}(o.Kc,e)):dr(),r.label=4;case 4:return[4,gh(o,s)];case 5:return r.sent(),[3,7];case 6:hr("SyncEngine","Cannot apply mutation batch with id: "+e),r.label=7;case 7:return[2]}}))}))}function Eh(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return Ah(n=yr(t)),Sh(n),!0!==e||!0===n.Hh?[3,3]:(i=n.kh.$u(),[4,Oh(n,i.O())]);case 1:return o=r.sent(),n.Hh=!0,[4,Pc(n.Oh,!0)];case 2:for(r.sent(),s=0,u=o;s<u.length;s++)pc(n.Oh,u[s]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(a=[],c=Promise.resolve(),n.qh.forEach((function(t,e){n.kh.zu(e)?a.push(e):c=c.then((function(){return lh(n,e),Za(n.Kc,e,!0)})),dc(n.Oh,e)})),[4,c]);case 4:return r.sent(),[4,Oh(n,a)];case 5:return r.sent(),function(t){var e=yr(t);e.Kh.forEach((function(t,n){dc(e.Oh,n)})),e.Wh.wu(),e.Kh=new Map,e.Qh=new Xr(Cr.V)}(n),n.Hh=!1,[4,Pc(n.Oh,!1)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))}function Oh(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h,f,l,p,d,v;return Object(r.e)(this,(function(r){switch(r.label){case 0:n=yr(t),i=[],o=[],s=0,u=e,r.label=1;case 1:return s<u.length?(c=void 0,(h=n.qh.get(a=u[s]))&&0!==h.length?[4,$a(n.Kc,vs(h[0]))]:[3,7]):[3,13];case 2:c=r.sent(),f=0,l=h,r.label=3;case 3:return f<l.length?(p=n.Bh.get(l[f]),[4,wh(n,p)]):[3,6];case 4:(d=r.sent()).snapshot&&o.push(d.snapshot),r.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,ec(n.Kc,a)];case 8:return v=r.sent(),[4,$a(n.Kc,v)];case 9:return c=r.sent(),[4,eh(n,Th(v),a,!1)];case 10:r.sent(),r.label=11;case 11:i.push(c),r.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Lh.Rc(o),i)]}}))}))}function Th(t){return us(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function jh(t){var e=yr(t);return yr(yr(e.Kc).persistence).Ca()}function Nh(t,e,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(o=yr(t)).Hh?(hr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,nc(o.Kc)];case 3:return s=r.sent(),u=di.Yt(e,"current"===n),[4,gh(o,s,u)];case 4:return r.sent(),[3,8];case 5:return[4,Za(o.Kc,e,!0)];case 6:return r.sent(),lh(o,e,i),[3,8];case 7:dr(),r.label=8;case 8:return[2]}}))}))}function xh(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l;return Object(r.e)(this,(function(p){switch(p.label){case 0:if(!(i=Ah(t)).Hh)return[3,10];o=0,s=e,p.label=1;case 1:return o<s.length?i.qh.has(u=s[o])?(hr("SyncEngine","Adding an already active target "+u),[3,5]):[4,ec(i.Kc,u)]:[3,6];case 2:return a=p.sent(),[4,$a(i.Kc,a)];case 3:return c=p.sent(),[4,eh(i,Th(a),c.targetId,!1)];case 4:p.sent(),pc(i.Oh,c),p.label=5;case 5:return o++,[3,1];case 6:h=function(t){return Object(r.e)(this,(function(e){switch(e.label){case 0:return i.qh.has(t)?[4,Za(i.Kc,t,!1).then((function(){dc(i.Oh,t),lh(i,t)})).catch(ic)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,p.label=7;case 7:return f<l.length?[5,h(l[f])]:[3,10];case 8:p.sent(),p.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function Ah(t){var e=yr(t);return e.Oh.jc.nu=ih.bind(null,e),e.Oh.jc.Be=mh.bind(null,e),e.Oh.jc.eu=sh.bind(null,e),e.Lh.Rc=uu.bind(null,e.Mh),e.Lh.Xh=au.bind(null,e.Mh),e}function Sh(t){var e=yr(t);return e.Oh.jc.su=uh.bind(null,e),e.Oh.jc.iu=ah.bind(null,e),e}var kh=function(){function t(){}return t.prototype.za=function(t){this.Zh=t},t.prototype.Ui=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.B())}(e)||n.isEqual(Ar.min())?this.tl(t,e):this.Zh.Li(t,r).next((function(s){var u=i.el(e,s);return(cs(e)||hs(e))&&i.ph(e.limitType,u,r,n)?i.tl(t,e):(cr()<=o.a.DEBUG&&hr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),_s(e)),i.Zh.Ui(t,e,n).next((function(t){return u.forEach((function(e){t=t.rt(e.key,e)})),t})))}))},t.prototype.el=function(t,e){var n=new Zr(Es(t));return e.forEach((function(e,r){r instanceof rs&&Is(t,r)&&(n=n.add(r))})),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.A(r)>0)},t.prototype.tl=function(t,e){return cr()<=o.a.DEBUG&&hr("IndexFreeQueryEngine","Using full collection scan to execute query:",_s(e)),this.Zh.Ui(t,e,Ar.min())},t}(),Dh=function(){function t(t,e){this.Fi=t,this.Lr=e,this.xi=[],this.nl=1,this.sl=new Zr(Rc.cu)}return t.prototype.Ur=function(t){return Bs.resolve(0===this.xi.length)},t.prototype.Qr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new gu(i,e,n,r);this.xi.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new Rc(a.key,i)),this.Fi.Kr(t,a.key.path.S())}return Bs.resolve(o)},t.prototype.Wr=function(t,e){return Bs.resolve(this.il(e))},t.prototype.Gr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return Bs.resolve(this.xi.length>r?this.xi[r]:null)},t.prototype.zr=function(){return Bs.resolve(0===this.xi.length?-1:this.nl-1)},t.prototype.Hr=function(t){return Bs.resolve(this.xi.slice())},t.prototype.Mi=function(t,e){var n=this,r=new Rc(e,0),i=new Rc(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Nt([r,i],(function(t){var e=n.il(t.Eu);o.push(e)})),Bs.resolve(o)},t.prototype.qi=function(t,e){var n=this,r=new Zr(mr);return e.forEach((function(t){var e=new Rc(t,0),i=new Rc(t,Number.POSITIVE_INFINITY);n.sl.Nt([e,i],(function(t){r=r.add(t.Eu)}))})),Bs.resolve(this.ol(r))},t.prototype.Gi=function(t,e){var n=e.path,r=n.length+1,i=n;Cr.G(i)||(i=i.child(""));var o=new Rc(new Cr(i),0),s=new Zr(mr);return this.sl.xt((function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(s=s.add(t.Eu)),!0)}),o),Bs.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.il(t);null!==r&&n.push(r)})),n},t.prototype.Yr=function(t,e){var n=this;vr(0===this.al(e.batchId,"removed")),this.xi.shift();var r=this.sl;return Bs.forEach(e.mutations,(function(i){var o=new Rc(i.key,e.batchId);return r=r.delete(o),n.Lr.eo(t,i.key)})).next((function(){n.sl=r}))},t.prototype.Zr=function(t){},t.prototype.so=function(t,e){var n=new Rc(e,0),r=this.sl.Ft(n);return Bs.resolve(e.isEqual(r&&r.key))},t.prototype.no=function(t){return Bs.resolve()},t.prototype.al=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.xi.length?0:t-this.xi[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.xi.length?null:this.xi[e]},t}(),Ph=function(){function t(t,e){this.Fi=t,this.cl=e,this.docs=new Xr(Cr.V),this.size=0}return t.prototype.Ri=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.cl(e);return this.docs=this.docs.rt(r,{gi:e,size:s,readTime:n}),this.size+=s-o,this.Fi.Kr(t,r.path.S())},t.prototype.Vi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.yi=function(t,e){var n=this.docs.get(e);return Bs.resolve(n?n.gi:null)},t.prototype.getEntries=function(t,e){var n=this,r=ri();return e.forEach((function(t){var e=n.docs.get(t);r=r.rt(t,e?e.gi:null)})),Bs.resolve(r)},t.prototype.Ui=function(t,e,n){for(var r=oi(),i=new Cr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.value,a=u.gi,c=u.readTime;if(!e.path.N(s.key.path))break;c.A(n)<=0||a instanceof rs&&Is(e,a)&&(r=r.rt(a.key,a))}return Bs.resolve(r)},t.prototype.ul=function(t,e){return Bs.forEach(this.docs,(function(t){return e(t)}))},t.prototype._o=function(t){return new Ch(this)},t.prototype.wo=function(t){return Bs.resolve(this.size)},t}(),Ch=function(t){function e(e){var n=this;return(n=t.call(this)||this).To=e,n}return Object(r.d)(e,t),e.prototype.bi=function(t){var e=this,n=[];return this.Ii.forEach((function(r,i){i&&i.gi?n.push(e.To.Ri(t,i.gi,e.Ai(r))):e.To.Vi(r)})),Bs.xn(n)},e.prototype.pi=function(t,e){return this.To.yi(t,e)},e.prototype.vi=function(t,e){return this.To.getEntries(t,e)},e}(mu),Lh=function(){function t(t){this.persistence=t,this.hl=new Tr((function(t){return qr(t)}),Fr),this.lastRemoteSnapshotVersion=Ar.min(),this.highestTargetId=0,this.ll=0,this._l=new Vc,this.targetCount=0,this.fl=Da.po()}return t.prototype.De=function(t,e){return this.hl.forEach((function(t,n){return e(n)})),Bs.resolve()},t.prototype.Co=function(t){return Bs.resolve(this.lastRemoteSnapshotVersion)},t.prototype.No=function(t){return Bs.resolve(this.ll)},t.prototype.bo=function(t){return this.highestTargetId=this.fl.next(),Bs.resolve(this.highestTargetId)},t.prototype.xo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Bs.resolve()},t.prototype.Oo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Da(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Fo=function(t,e){return this.Oo(e),this.targetCount+=1,Bs.resolve()},t.prototype.ko=function(t,e){return this.Oo(e),Bs.resolve()},t.prototype.$o=function(t,e){return this.hl.delete(e.target),this._l.du(e.targetId),this.targetCount-=1,Bs.resolve()},t.prototype.Nr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.Lo(t,u.targetId)),i++)})),Bs.xn(o).next((function(){return i}))},t.prototype.Bo=function(t){return Bs.resolve(this.targetCount)},t.prototype.qo=function(t,e){var n=this.hl.get(e)||null;return Bs.resolve(n)},t.prototype.Uo=function(t,e,n){return this._l.lu(e,n),Bs.resolve()},t.prototype.Ko=function(t,e,n){this._l.fu(e,n);var r=this.persistence.Lr,i=[];return r&&e.forEach((function(e){i.push(r.eo(t,e))})),Bs.xn(i)},t.prototype.Lo=function(t,e){return this._l.du(e),Bs.resolve()},t.prototype.jo=function(t,e){var n=this._l.Tu(e);return Bs.resolve(n)},t.prototype.so=function(t,e){return Bs.resolve(this._l.so(e))},t}(),Vh=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.mo=function(t,e){return Bs.resolve(this.dl.get(e))},t.prototype.Ao=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:Xi(n.createTime)}),Bs.resolve()},t.prototype.Ro=function(t,e){return Bs.resolve(this.wl.get(e))},t.prototype.Po=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:Hu(n.bundledQuery),readTime:Xi(n.readTime)}),Bs.resolve()},t}(),Rh=function(){function t(t,e){var n=this;this.Tl={},this.Jo=new ju(0),this.Yo=!1,this.Yo=!0,this.Lr=t(this),this.ra=new Lh(this),this.Fi=new sa,this.Ni=function(t,e){return new Ph(t,(function(t){return n.Lr.El(t)}))}(this.Fi),this.serializer=new Ru(e),this.oa=new Vh(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.pa=function(){return this.Yo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"yr",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),t.prototype.fa=function(){},t.prototype.da=function(){},t.prototype.Oa=function(){return this.Fi},t.prototype.Na=function(t){var e=this.Tl[t.Ys()];return e||(e=new Dh(this.Fi,this.Lr),this.Tl[t.Ys()]=e),e},t.prototype.xa=function(){return this.ra},t.prototype.Fa=function(){return this.Ni},t.prototype.Ma=function(){return this.oa},t.prototype.runTransaction=function(t,e,n){var r=this;hr("MemoryPersistence","Starting transaction:",t);var i=new Mh(this.Jo.next());return this.Lr.Il(),n(i).next((function(t){return r.Lr.ml(i).next((function(){return t}))})).Cn().then((function(t){return i.Ci(),t}))},t.prototype.Al=function(t,e){return Bs.Fn(Object.values(this.Tl).map((function(n){return function(){return n.so(t,e)}})))},t}(),Mh=function(t){function e(e){var n=this;return(n=t.call(this)||this).Go=e,n}return Object(r.d)(e,t),e}(Eu),Uh=function(){function t(t){this.persistence=t,this.Rl=new Vc,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"Vl",{get:function(){if(this.Pl)return this.Pl;throw dr()},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t,e,n){return this.Rl.Qo(n,e),this.Vl.delete(n.toString()),Bs.resolve()},t.prototype.Wo=function(t,e,n){return this.Rl.Wo(n,e),this.Vl.add(n.toString()),Bs.resolve()},t.prototype.eo=function(t,e){return this.Vl.add(e.toString()),Bs.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.du(e.targetId).forEach((function(t){return n.Vl.add(t.toString())}));var r=this.persistence.xa();return r.jo(t,e.targetId).next((function(t){t.forEach((function(t){return n.Vl.add(t.toString())}))})).next((function(){return r.$o(t,e)}))},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Fa()._o();return Bs.forEach(this.Vl,(function(r){var i=Cr.K(r);return e.yl(t,i).next((function(t){t||n.Vi(i)}))})).next((function(){return e.Pl=null,n.apply(t)}))},t.prototype.qa=function(t,e){var n=this;return this.yl(t,e).next((function(t){t?n.Vl.delete(e.toString()):n.Vl.add(e.toString())}))},t.prototype.El=function(t){return 0},t.prototype.yl=function(t,e){var n=this;return Bs.Fn([function(){return Bs.resolve(n.Rl.so(e))},function(){return n.persistence.xa().so(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),qh=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.mc=function(t){this.bl=t},t.prototype.dc=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),Fh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(r.d)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise((function(i,o){var s=new ir;s.listenOnce(nr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case er.NO_ERROR:var e=s.getResponseJson();hr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case er.TIMEOUT:hr("Connection",'RPC "'+t+'" timed out'),o(new Nr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case er.HTTP_ERROR:var n=s.getStatus();if(hr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(jr).indexOf(e)>=0?e:jr.UNKNOWN}(r.status);o(new Nr(u,r.message))}else o(new Nr(jr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Nr(jr.UNAVAILABLE,"Connection failed."));break;default:dr()}}finally{hr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.Ac=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Xn,i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(i.initMessageHeaders,e),Object(s.l)()||Object(s.n)()||Object(s.j)()||Object(s.k)()||Object(s.o)()||Object(s.i)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");hr("Connection","Creating WebChannel: "+o,i);var u=r.createWebChannel(o,i),a=!1,c=!1,h=new qh({pl:function(t){c?hr("Connection","Not sending because WebChannel is closed:",t):(a||(hr("Connection","Opening WebChannel transport."),u.open(),a=!0),hr("Connection","WebChannel sending:",t),u.send(t))},vl:function(){return u.close()}}),f=function(t,e){u.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(rr.EventType.OPEN,(function(){c||hr("Connection","WebChannel transport opened.")})),f(rr.EventType.CLOSE,(function(){c||(c=!0,hr("Connection","WebChannel transport closed"),h.Nl())})),f(rr.EventType.ERROR,(function(t){c||(c=!0,lr("Connection","WebChannel transport errored:",t),h.Nl(new Nr(jr.UNAVAILABLE,"The operation could not be completed")))})),f(rr.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];vr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){hr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=zr[t];if(void 0!==e)return Yr(e)}(i),s=r.message;void 0===o&&(o=jr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new Nr(o,s)),u.close()}else hr("Connection","WebChannel received:",n),h.xl(n)}})),setTimeout((function(){h.Cl()}),0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.xc=function(t,e,n,r){var i=this.kl(t,e);hr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then((function(t){return hr("RestConnection","Received: ",t),t}),(function(e){throw lr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Fc=function(t,e,n,r){return this.xc(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2",t["Content-Type"]="text/plain",e)for(var n in e.ti)e.ti.hasOwnProperty(n)&&(t[n]=e.ti[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+Fh[t]},t}()),Gh=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Xc=function(t){this.Kl.push(t)},t.prototype.pa=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){hr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){hr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),zh=function(){function t(){}return t.prototype.Xc=function(t){},t.prototype.pa=function(){},t}(),Kh=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return this.serializer=wu(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Kc=this.Jl(t),[2]}}))}))},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Qa(this.persistence,new kh,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new Rh(Uh.gl,this.serializer)},t.prototype.jl=function(t){return new Hc},t.prototype.terminate=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.pa()];case 1:return t.sent(),[4,this.persistence.pa()];case 2:return t.sent(),[2]}}))}))},t}(),Qh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(r.d)(e,t),e.prototype.initialize=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,rc(this.Kc)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Sh(this.Xl.gu)];case 4:return n.sent(),[4,jc(this.Xl.Oh)];case 5:return n.sent(),[2]}}))}))},e.prototype.Jl=function(t){return Qa(this.persistence,new kh,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new ku(this.persistence.Lr.Rr,t.rs)},e.prototype.Gl=function(t){var e=za(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Su.Tr(this.cacheSizeBytes):Su.mr;return new Ua(this.synchronizeTabs,e,t.clientId,n,t.rs,$s(),Zs(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new Hc},e}(Kh),Hh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(r.d)(e,t),e.prototype.initialize=function(e){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.e)(this,(function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),n=this.Xl.gu,this.kh instanceof Qc?(this.kh.gu={_h:Ih.bind(null,n),fh:Nh.bind(null,n),dh:xh.bind(null,n),Ca:jh.bind(null,n),lh:_h.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence._a((function(t){return Object(r.b)(i,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,Eh(this.Xl.gu,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.yr?this.zl.start(this.Kc):t||this.zl.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},e.prototype.jl=function(t){var e=$s();if(!Qc.kn(e))throw new Nr(jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=za(t.Fl.t,t.Fl.persistenceKey);return new Qc(e,t.rs,n,t.clientId,t.Yl)},e}(Qh),Wh=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return this.Kc?[3,2]:(this.Kc=t.Kc,this.kh=t.kh,this.Wc=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.gu=this.n_(e,!t.synchronizeTabs),this.kh.Oc=function(t){return oh(n.gu,t,1)},this.Oh.jc.s_=bh.bind(null,this.gu),[4,Pc(this.Oh,this.gu.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.e_=function(t){return new iu},t.prototype.Zl=function(t){var e=wu(t.Fl.t),n=new Bh(t.Fl);return function(t,e,n){return new ac(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Kc,n=this.Wc,r=t.rs,i=function(t){return oh(s.gu,t,0)},o=Gh.kn()?new Gh:new zh,new hc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Zc(t,e,n,r,i,o);return s&&(u.Hh=!0),u}(this.Kc,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:return e=yr(t),hr("RemoteStore","RemoteStore shutting down."),e.Hc.add(5),[4,lc(e)];case 1:return n.sent(),e.Yc.pa(),e.Zc.set("Unknown"),[2]}}))}))}(this.Oh)},t}(),Yh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Xh=function(t){this.o_=t};function Jh(t,e,n){if(!n)throw new Nr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function $h(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zh(t,e,n,r){if(!0===e&&!0===r)throw new Nr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function tf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":dr()}function ef(t,e){if(t instanceof Xh&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Nr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=tf(t);throw new Nr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function nf(t,e){if(e<=0)throw new Nr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var rf=function(t){this.a_=t},of=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.c_=function(t){if(2!==t.u_)throw t.h_(1===t.u_?this.a_+"() can only appear at the top level of your update data":this.a_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(rf);function sf(t,e,n){return new Df({u_:3,l_:e.settings.l_,methodName:t.a_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var uf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.c_=function(t){return new Lo(t.path,new jo)},e.prototype.isEqual=function(t){return t instanceof e},e}(rf),af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(r.d)(e,t),e.prototype.c_=function(t){var e=sf(this,t,!0),n=this.f_.map((function(t){return Mf(t,e)})),r=new No(n);return new Lo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rf),cf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(r.d)(e,t),e.prototype.c_=function(t){var e=sf(this,t,!0),n=this.f_.map((function(t){return Mf(t,e)})),r=new Ao(n);return new Lo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rf),hf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return Object(r.d)(e,t),e.prototype.c_=function(t){var e=new ko(t.serializer,Qi(t.serializer,this.d_));return new Lo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(rf),ff=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Nr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Nr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.T_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.T_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.T_===t.T_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.T_}},t.prototype.I=function(t){return mr(this.w_,t.w_)||mr(this.T_,t.T_)},t}(),lf=function(){function t(t){this.E_=t}return t.fromBase64String=function(e){try{return new t(Gr.fromBase64String(e))}catch(e){throw new Nr(jr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Gr.fromUint8Array(e))},t.prototype.toBase64=function(){return this.E_.toBase64()},t.prototype.toUint8Array=function(){return this.E_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},t}(),pf=new Map,df=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Nr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Zh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}();function vf(){if("undefined"==typeof Uint8Array)throw new Nr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function yf(){if("undefined"==typeof atob)throw new Nr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.fromBase64String=function(t){yf();try{return new e(Gr.fromBase64String(t))}catch(t){throw new Nr(jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){return vf(),new e(Gr.fromUint8Array(t))},e.prototype.toBase64=function(){return yf(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return vf(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(lf),bf=function(){function t(){}return t.prototype.I_=function(t,e){switch(void 0===e&&(e="none"),ji(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Pi(t.integerValue||t.doubleValue);case 3:return this.m_(t.timestampValue);case 4:return this.A_(t,e);case 5:return t.stringValue;case 6:return this.R_(Ci(t.bytesValue));case 7:return this.P_(t.referenceValue);case 8:return this.g_(t.geoPointValue);case 9:return this.V_(t.arrayValue,e);case 10:return this.y_(t.mapValue,e);default:throw dr()}},t.prototype.y_=function(t,e){var n=this,r={};return Er(t.fields||{},(function(t,i){r[t]=n.I_(i,e)})),r},t.prototype.g_=function(t){return new ff(Pi(t.latitude),Pi(t.longitude))},t.prototype.V_=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.I_(t,e)}))},t.prototype.A_=function(t,e){switch(e){case"previous":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return Ei(n)?t(n):n}(t);return null==n?null:this.I_(n,e);case"estimate":return this.m_(Oi(t));default:return null}},t.prototype.m_=function(t){var e=Di(t);return new xr(e.seconds,e.nanos)},t.prototype.p_=function(t,e){var n=kr.k(t);vr(_o(n));var r=new ur(n.get(1),n.get(3)),i=new Cr(n.v(5));return r.isEqual(e)||fr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),mf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(r.d)(e,t),e.prototype.R_=function(t){return new gf(t)},e.prototype.P_=function(t){var e=this.p_(t,this.firestore.v_);return jl.b_(e,this.firestore,null)},e}(bf),wf=function(){function t(t,e,n,r,i){this.S_=t,this.D_=e,this.C_=n,this.N_=r,this.x_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Of(this.S_,this.x_,this.C_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.N_},t.prototype.data=function(){if(this.N_){if(this.x_){var t=new _f(this.S_,this.D_,this.C_,this.N_,null);return this.x_.fromFirestore(t)}return this.D_.I_(this.N_.sn())}},t.prototype.get=function(t){if(this.N_){var e=this.N_.data().field(If("DocumentSnapshot.get",t));if(null!==e)return this.D_.I_(e)}},t}(),_f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(wf);function If(t,e){return"string"==typeof e?zf(t,e):e instanceof Xh?e.o_.F_:e.F_}var Ef=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Nr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new Pr(t)}return t.prototype.isEqual=function(t){return this.F_.isEqual(t.F_)},t}(),Of=function(){function t(t,e,n){this.x_=e,this.C_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"O_",{get:function(){return this.C_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.C_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.C_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new jf(this.firestore,this.x_,this.C_.path.S())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Tf=function(){function t(t,e,n){this.x_=e,this.M_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.M_)},t}(),jf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,as(r))||this).firestore=e,i.O_=r,i.type="collection",i}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.O_.S();return t.T()?null:new Of(this.firestore,null,new Cr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.O_)},e}(Tf);function Nf(t){var e=t.k_(),n=wu(t.v_);return new Pf(t.v_,!!e.ignoreUndefinedProperties,n)}var xf=/^__.*__$/,Af=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.L_=function(t,e){var n=[];return n.push(null!==this.Qe?new Qo(t,this.data,this.Qe,e):new Ko(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Wo(t,this.fieldTransforms)),n},t}(),Sf=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.L_=function(t,e){var n=[new Qo(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new Wo(t,this.fieldTransforms)),n},t}();function kf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dr()}}var Df=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.B_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),t.prototype.q_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.q_({path:n,__:!1});return r.Q_(t),r},t.prototype.K_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.q_({path:n,__:!1});return r.B_(),r},t.prototype.W_=function(t){return this.q_({path:void 0,__:!0})},t.prototype.h_=function(t){return Kf(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.N(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.N(e.field)}))},t.prototype.B_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Q_(this.path.get(t))},t.prototype.Q_=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(kf(this.u_)&&xf.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),Pf=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||wu(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Df({u_:t,methodName:e,l_:n,path:Pr.$(),__:!1,j_:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Cf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Ff("Data must be an object, but it was:",s,r);var u,a,c=Uf(r,s);if(o.merge)u=new Co(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Bf(e,l[f],n);if(!s.contains(p))throw new Nr(jr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Qf(h,p)||h.push(p)}u=new Co(h),a=s.fieldTransforms.filter((function(t){return u.He(t.field)}))}else u=null,a=s.fieldTransforms;return new Af(new Zo(c),u,a)}function Lf(t,e,n,r){var i=t.G_(1,e,n);Ff("Data must be an object, but it was:",i,r);var o=[],s=new ts;Er(r,(function(t,r){var u=zf(e,t,n);r instanceof Xh&&(r=r.o_);var a=i.K_(u);if(r instanceof of)o.push(u);else{var c=Mf(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Co(o);return new Sf(s.Ye(),u,i.fieldTransforms)}function Vf(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Bf(e,r,n)],a=[i];if(o.length%2!=0)throw new Nr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Bf(e,o[c])),a.push(o[c+1]);for(var h=[],f=new ts,l=u.length-1;l>=0;--l)if(!Qf(h,u[l])){var p=u[l],d=a[l];d instanceof Xh&&(d=d.o_);var v=s.K_(p);if(d instanceof of)h.push(p);else{var y=Mf(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Co(h);return new Sf(f.Ye(),g,s.fieldTransforms)}function Rf(t,e,n,r){return void 0===r&&(r=!1),Mf(n,t.G_(r?4:3,e))}function Mf(t,e){if(t instanceof Xh&&(t=t.o_),qf(t))return Ff("Unsupported field value:",e,t),Uf(t,e);if(t instanceof rf)return function(t,e){if(!kf(e.u_))throw e.h_(t.a_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.a_+"() is not currently supported inside arrays");var n=t.c_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.u_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Mf(o[i],e.W_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Xh&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Qi(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=xr.fromDate(t);return{timestampValue:Hi(e.serializer,n)}}if(t instanceof xr){var r=new xr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Hi(e.serializer,r)}}if(t instanceof ff)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof lf)return{bytesValue:Wi(e.serializer,t.E_)};if(t instanceof Of){var i=e.t,o=t.firestore.v_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Ji(t.firestore.v_||e.t,t.C_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+tf(t))}(t,e)}function Uf(t,e){var n={};return Or(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):Er(t,(function(t,r){var i=Mf(r,e.U_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function qf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof ff||t instanceof lf||t instanceof Of||t instanceof rf)}function Ff(t,e,n){if(!qf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=tf(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function Bf(t,e,n){if(e instanceof Xh&&(e=e.o_),e instanceof Ef)return e.F_;if("string"==typeof e)return zf(t,e);throw Kf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Gf=new RegExp("[~\\*/\\[\\]]");function zf(t,e,n){if(e.search(Gf)>=0)throw Kf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Ef.bind.apply(Ef,Object(r.h)([void 0],e.split("."))))).F_}catch(i){throw Kf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Kf(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Nr(jr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Qf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Hf=function(){function t(t){this.Wc=t,this.z_=new Map,this.mutations=[],this.H_=!1,this.J_=null,this.Y_=new Set}return t.prototype.X_=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n=this;return Object(r.e)(this,(function(i){switch(i.label){case 0:if(this.Z_(),this.mutations.length>0)throw new Nr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,u,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=yr(t),i=ro(n.serializer)+"/documents",o={documents:e.map((function(t){return Zi(n.serializer,t)}))},[4,n.Fc("BatchGetDocuments",i,o)];case 1:return s=r.sent(),u=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){vr(!!e.found);var n=to(t,e.found.name),r=Xi(e.found.updateTime),i=new Zo({mapValue:{fields:e.found.fields}});return new rs(n,r,i,{})}(t,e):"missing"in e?function(t,e){vr(!!e.missing),vr(!!e.readTime);var n=to(t,e.missing),r=Xi(e.readTime);return new is(n,r)}(t,e):dr()}(n.serializer,t);u.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());vr(!!e),a.push(e)})),a)]}}))}))}(this.Wc,t)];case 1:return[2,((e=i.sent()).forEach((function(t){t instanceof is||t instanceof rs?n.tf(t):dr()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.L_(t,this.je(t))),this.Y_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.L_(t,this.ef(t)))}catch(t){this.J_=t}this.Y_.add(t.toString())},t.prototype.delete=function(t){this.write([new Jo(t,this.je(t))]),this.Y_.add(t.toString())},t.prototype.commit=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e=this;return Object(r.e)(this,(function(n){switch(n.label){case 0:if(this.Z_(),this.J_)throw this.J_;return t=this.z_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Cr.K(n);e.mutations.push(new $o(r,e.je(r)))})),[4,function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=yr(t),i=ro(n.serializer)+"/documents",o={writes:e.map((function(t){return so(n.serializer,t)}))},[4,n.xc("Commit",i,o)];case 1:return r.sent(),[2]}}))}))}(this.Wc,this.mutations)];case 1:return n.sent(),this.H_=!0,[2]}}))}))},t.prototype.tf=function(t){var e;if(t instanceof rs)e=t.version;else{if(!(t instanceof is))throw dr();e=Ar.min()}var n=this.z_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Nr(jr.ABORTED,"Document version changed between two reads.")}else this.z_.set(t.key.toString(),e)},t.prototype.je=function(t){var e=this.z_.get(t.toString());return!this.Y_.has(t.toString())&&e?Ro.updateTime(e):Ro.Ge()},t.prototype.ef=function(t){var e=this.z_.get(t.toString());if(!this.Y_.has(t.toString())&&e){if(e.isEqual(Ar.min()))throw new Nr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ro.updateTime(e)}return Ro.exists(!0)},t.prototype.write=function(t){this.Z_(),this.mutations=this.mutations.concat(t)},t.prototype.Z_=function(){},t}(),Wf=function(){function t(t,e,n,r){this.rs=t,this.Wc=e,this.updateFunction=n,this.us=r,this.nf=5,this.Ps=new Fs(this.rs,"transaction_retry")}return t.prototype.run=function(){this.sf()},t.prototype.sf=function(){var t=this;this.Ps.An((function(){return Object(r.b)(t,void 0,void 0,(function(){var t,e,n=this;return Object(r.e)(this,(function(r){return t=new Hf(this.Wc),(e=this.rf(t))&&e.then((function(e){n.rs.fs((function(){return t.commit().then((function(){n.us.resolve(e)})).catch((function(t){n.af(t)}))}))})).catch((function(t){n.af(t)})),[2]}))}))}))},t.prototype.rf=function(t){try{var e=this.updateFunction(t);return!Lr(e)&&e.catch&&e.then?e:(this.us.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.us.reject(t),null}},t.prototype.af=function(t){var e=this;this.nf>0&&this.cf(t)?(this.nf-=1,this.rs.fs((function(){return e.sf(),Promise.resolve()}))):this.us.reject(t)},t.prototype.cf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Wr(e)}return!1},t}(),Yf=function(){function t(t,e,n){var r=this;this.credentials=t,this.rs=e,this.Fl=n,this.user=fu.UNAUTHENTICATED,this.clientId=br.u(),this.uf=function(){},this.oi=new qs,this.credentials.si((function(t){hr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.uf(t)),r.oi.resolve()}))}return t.prototype.getConfiguration=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return[4,this.oi.promise];case 1:return[2,(t.sent(),{rs:this.rs,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}}))}))},t.prototype.hf=function(t){var e=this;this.uf=t,this.oi.promise.then((function(){return e.uf(e.user)}))},t.prototype.lf=function(){if(this.rs.Vs)throw new Nr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.rs.bs();var e=new qs;return this.rs.ys((function(){return Object(r.b)(t,void 0,void 0,(function(){var t,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this._f?[4,this._f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.ff?[4,this.ff.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.ii(),e.resolve(),[3,6];case 5:return t=r.sent(),n=nu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function Xf(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.e)(this,(function(o){switch(o.label){case 0:return t.rs.Ns(),hr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),t.hf((function(n){return t.rs.Ss((function(){return Object(r.b)(i,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return[4,Ha(e.Kc,n)];case 1:return t.sent(),[2]}}))}))}))})),e.persistence.fa((function(){return t.terminate()})),t.ff=e,[2]}}))}))}function Jf(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(o){switch(o.label){case 0:return t.rs.Ns(),[4,$f(t)];case 1:return n=o.sent(),hr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return i=o.sent(),[4,e.initialize(n,i)];case 3:return o.sent(),t.hf((function(n){return t.rs.Ss((function(){return function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(n=yr(t)).rs.Ns(),hr("RemoteStore","RemoteStore received new credentials"),i=mc(n),n.Hc.add(3),[4,lc(n)];case 1:return r.sent(),i&&n.Zc.set("Unknown"),[4,n.jc.s_(e)];case 2:return r.sent(),n.Hc.delete(3),[4,fc(n)];case 3:return r.sent(),[2]}}))}))}(e.Oh,n)}))})),t._f=e,[2]}}))}))}function $f(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return t.ff?[3,2]:(hr("FirestoreClient","Using default OfflineComponentProvider"),[4,Xf(t,new Kh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.ff]}}))}))}function Zf(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return t._f?[3,2]:(hr("FirestoreClient","Using default OnlineComponentProvider"),[4,Jf(t,new Wh)]);case 1:e.sent(),e.label=2;case 2:return[2,t._f]}}))}))}function tl(t){return $f(t).then((function(t){return t.persistence}))}function el(t){return $f(t).then((function(t){return t.Kc}))}function nl(t){return Zf(t).then((function(t){return t.Oh}))}function rl(t){return Zf(t).then((function(t){return t.gu}))}function il(t){return Object(r.b)(this,void 0,void 0,(function(){var e,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,Zf(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ls=th.bind(null,e.gu),n.Us=nh.bind(null,e.gu),n)]}}))}))}function ol(t,e){var n=this,i=new qs;return t.rs.fs((function(){return Object(r.b)(n,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=rh,[4,rl(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,i])]}}))}))})),i.promise}function sl(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t,e){var n=yr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Ga.Oi(t,e)}))}(t,e)];case 1:return(i=r.sent())instanceof rs?n.resolve(i):i instanceof is?n.resolve(null):n.reject(new Nr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=r.sent(),s=nu(o,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}}))}))}function ul(t,e,n,r,i){var o=new Yh({next:function(o){e.fs((function(){return su(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Nr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Nr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new hu(as(n.path),o,{includeMetadataChanges:!0,Hs:!0});return ou(t,s)}var al=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).yf=new eu,r.df="name"in e?e.name:"[DEFAULT]",r}return Object(r.d)(e,t),e.prototype.Vf=function(){return this.pf||El(this),this.pf.terminate()},e}(function(){function t(t,e){this.df="(lite)",this.wf=new df({}),this.Tf=!1,t instanceof ur?(this.v_=t,this.Ef=new pu):(this.If=t,this.v_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Nr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ur(t.options.projectId)}(t),this.Ef=new du(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.If)throw new Nr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.If},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mf",{get:function(){return this.Tf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Af",{get:function(){return void 0!==this.Rf},enumerable:!1,configurable:!0}),t.prototype.Pf=function(t){if(this.Tf)throw new Nr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.wf=new df(t),void 0!==t.credentials&&(this.Ef=function(t){if(!t)return new pu;switch(t.type){case"gapi":var e=t.client;return vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new yu(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Nr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.gf=function(){return this.wf},t.prototype.k_=function(){return this.Tf=!0,this.wf},t.prototype._delete=function(){return this.Rf||(this.Rf=this.Vf()),this.Rf},t.prototype.Vf=function(){return function(t){var e=pf.get(t);e&&(hr("ComponentProvider","Removing Datastore"),pf.delete(t),e.terminate())}(this),Promise.resolve()},t}());function cl(t,e,n){var i=this,o=new qs;return t.rs.enqueue((function(){return Object(r.b)(i,void 0,void 0,(function(){var i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,Xf(t,n)];case 1:return r.sent(),[4,Jf(t,e)];case 2:return r.sent(),o.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===jr.FAILED_PRECONDITION||t.code===jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(i=r.sent()))throw i;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),o.reject(i),[3,4];case 4:return[2]}}))}))})).then((function(){return o.promise}))}function hl(t){if(t.mf||t.Af)throw new Nr(jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var fl=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).S_=e,u.vf=e,u.metadata=o,u}return Object(r.d)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.N_){if(this.x_){var e=new ll(this.S_,this.D_,this.C_,this.N_,this.metadata,null);return this.x_.fromFirestore(e,t)}return this.D_.I_(this.N_.sn(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.N_){var n=this.N_.data().field(If("DocumentSnapshot.get",t));if(null!==n)return this.D_.I_(n,e.serverTimestamps)}},e}(wf),ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(fl),pl=function(){function t(t,e,n,r){this.S_=t,this.D_=e,this.bf=r,this.metadata=new xl(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.bf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.bf.docs.forEach((function(r){t.call(e,new ll(n.S_,n.D_,r.key,r,new xl(n.bf.Qt.has(r.key),n.bf.fromCache),n.query.x_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.bf.Wt)throw new Nr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Sf&&this.Df===e||(this.Sf=function(t,e){if(t.bf.Ut.T()){var n=0;return t.bf.docChanges.map((function(e){return{type:"added",doc:new ll(t.S_,t.D_,e.doc.key,e.doc,new xl(t.bf.Qt.has(e.doc.key),t.bf.fromCache),t.query.x_),oldIndex:-1,newIndex:n++}}))}var r=t.bf.Ut;return t.bf.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new ll(t.S_,t.D_,e.doc.key,e.doc,new xl(t.bf.Qt.has(e.doc.key),t.bf.fromCache),t.query.x_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:dl(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.Df=e),this.Sf},t}();function dl(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dr()}}function vl(t,e){return t instanceof fl&&e instanceof fl?t.S_===e.S_&&t.C_.isEqual(e.C_)&&(null===t.N_?null===e.N_:t.N_.isEqual(e.N_))&&t.x_===e.x_:t instanceof pl&&e instanceof pl&&t.S_===e.S_&&function(t,e){return t instanceof Tf&&e instanceof Tf&&t.firestore===e.firestore&&ms(t.M_,e.M_)&&t.x_===e.x_}(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.bf.isEqual(e.bf)}var yl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(r.d)(e,t),e.prototype.R_=function(t){return new lf(t)},e.prototype.P_=function(t){var e=this.p_(t,this.firestore.v_);return new Of(this.firestore,null,e)},e}(bf);function gl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=ef(t.firestore,al),s=Nf(o);return e instanceof Xh&&(e=e.o_),bl(o,("string"==typeof e||e instanceof Ef?Vf(s,"updateDoc",t.C_,e,n,r):Lf(s,"updateDoc",t.C_,e)).L_(t.C_,Ro.exists(!0)))}function bl(t,e){return ol(Il(t),e)}function ml(t,e,n){var r=n.docs.get(e.C_),i=new yl(t);return new fl(t,i,e.C_,r,new xl(n.hasPendingWrites,n.fromCache),e.x_)}var wl=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){hl(t);var n=Il(t),r=t.k_(),i=new Wh;return cl(n,i,new Qh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){hl(t);var e=Il(t),n=t.k_(),r=new Wh;return cl(e,r,new Hh(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.mf&&!t.Af)throw new Nr(jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new qs;return t.yf.ys((function(){return Object(r.b)(e,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return Gs.kn()?[4,Gs.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(za(t.v_,t.df))];case 1:return i.sent(),n.resolve(),[3,3];case 2:return e=i.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.o_)},t}(),_l=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Cf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof ur||(i.Nf=e),i}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"v_",{get:function(){return this.o_.v_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.gf()),t)).merge,this.o_.Pf(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.gf().host&&lr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.rs.enqueue((function(){return Object(r.b)(e,void 0,void 0,(function(){var e,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,tl(t)];case 1:return e=r.sent(),[4,nl(t)];case 2:return n=r.sent(),[2,(e.da(!0),function(t){var e=yr(t);return e.Hc.delete(0),fc(e)}(n))]}}))}))}))}(Il(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.rs.enqueue((function(){return Object(r.b)(e,void 0,void 0,(function(){var e,n;return Object(r.e)(this,(function(i){switch(i.label){case 0:return[4,tl(t)];case 1:return e=i.sent(),[4,nl(t)];case 2:return n=i.sent(),[2,(e.da(!1),function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:return(e=yr(t)).Hc.add(0),[4,lc(e)];case 1:return n.sent(),e.Zc.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Il(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Zh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Cf.enableMultiTabIndexedDbPersistence(this):this.Cf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Cf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new qs;return t.rs.fs((function(){return Object(r.b)(e,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(r){switch(r.label){case 0:return e=ch,[4,rl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Il(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,i=Il(t),o=_u(e)?e:{next:e},s=new Yh(o);return t.yf.fs((function(){return Object(r.b)(n,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(e){switch(e.label){case 0:return t=function(t,e){yr(t).$s.add(e),e.next()},[4,il(i)];case 1:return t.apply(void 0,[e.sent(),s]),[2]}}))}))})),function(){s.r_(),t.yf.fs((function(){return Object(r.b)(n,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(e){switch(e.label){case 0:return t=function(t,e){yr(t).$s.delete(e)},[4,il(i)];case 1:return t.apply(void 0,[e.sent(),s]),[2]}}))}))}))}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Nf)throw new Nr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){return Jh("Firestore.collection","path",t),Il(this.o_),new Ml(kr.k(t),this,null)},e.prototype.doc=function(t){return Jh("Firestore.doc","path",t),Il(this.o_),jl.xf(kr.k(t),this,null)},e.prototype.collectionGroup=function(t){if(Jh("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new Nr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Il(this.o_),new Ll(function(t){return new ss(kr.$(),t)}(t),this,null)},e.prototype.runTransaction=function(t){var e=this;return function(t,e){var n=this,i=new qs;return t.rs.fs((function(){return Object(r.b)(n,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,function(t){return Zf(t).then((function(t){return t.Wc}))}(t)];case 1:return n=r.sent(),new Wf(t.rs,n,e,i).run(),[2]}}))}))})),i.promise}(Il(this.o_),(function(n){return t(new Ol(e,n))}))},e.prototype.batch=function(){return Il(this.o_),new Tl(this)},e}(Xh);function Il(t){return t.pf||El(t),t.pf.lf(),t.pf}function El(t){var e=t.k_(),n=function(t,e,n){return new sr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.v_,t.df,e);t.pf=new Yf(t.Ef,t.yf,n)}var Ol=function(){function t(t,e){this.S_=t,this.Ff=e,this.Of=Nf(this.S_.o_)}return t.prototype.get=function(t){var e=this,n=Ul(0,t,this.S_),r=new mf(this.S_);return this.Ff.X_([n.C_]).then((function(t){if(!t||1!==t.length)return dr();var i=t[0];if(i instanceof is)return new Al(e.S_,new fl(e.S_.o_,r,n.C_,null,new xl(!1,!1),n.x_));if(i instanceof rs)return new Al(e.S_,new fl(e.S_.o_,r,n.C_,i,new xl(!1,!1),n.x_));throw dr()}))},t.prototype.set=function(t,e,n){var r=Ul(0,t,this.S_);n=$h("Transaction.set",n);var i=ql(r.x_,e,n),o=Cf(this.Of,"Transaction.set",r.C_,i,null!==r.x_,n);return this.Ff.set(r.C_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Ul(0,t,this.S_);return e instanceof Xh&&(e=e.o_),o="string"==typeof e||e instanceof Ef?Vf(this.Of,"Transaction.update",s.C_,e,n,r):Lf(this.Of,"Transaction.update",s.C_,e),this.Ff.update(s.C_,o),this},t.prototype.delete=function(t){var e=Ul(0,t,this.S_);return this.Ff.delete(e.C_),this},t}(),Tl=function(){function t(t){this.S_=t,this.Mf=[],this.kf=!1,this.Of=Nf(this.S_.o_)}return t.prototype.set=function(t,e,n){this.$f();var r=Ul(0,t,this.S_);n=$h("WriteBatch.set",n);var i=ql(r.x_,e,n),o=Cf(this.Of,"WriteBatch.set",r.C_,i,null!==r.x_,n);return this.Mf=this.Mf.concat(o.L_(r.C_,Ro.Ge())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.$f();var o,s=Ul(0,t,this.S_);return e instanceof Xh&&(e=e.o_),o="string"==typeof e||e instanceof Ef?Vf(this.Of,"WriteBatch.update",s.C_,e,n,r):Lf(this.Of,"WriteBatch.update",s.C_,e),this.Mf=this.Mf.concat(o.L_(s.C_,Ro.exists(!0))),this},t.prototype.delete=function(t){this.$f();var e=Ul(0,t,this.S_);return this.Mf=this.Mf.concat(new Jo(e.C_,Ro.Ge())),this},t.prototype.commit=function(){return this.$f(),this.kf=!0,this.Mf.length>0?ol(Il(this.S_.o_),this.Mf):Promise.resolve()},t.prototype.$f=function(){if(this.kf)throw new Nr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),jl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.D_=new mf(e),r}return Object(r.d)(e,t),e.xf=function(t,n,r){if(t.length%2!=0)throw new Nr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.M()+" has "+t.length);return new e(n,new Of(n.o_,r,new Cr(t)))},e.b_=function(t,n,r){return new e(n,new Of(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ml(this.o_.O_.S(),this.firestore,this.o_.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(Jh("DocumentReference.collection","path",t),!t)throw new Nr(jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=kr.k(t);return new Ml(this.o_.O_.child(e),this.firestore,null)},e.prototype.isEqual=function(t){return t instanceof Xh&&(t=t.o_),t instanceof Of&&(n=t,((e=this.o_)instanceof Of||e instanceof jf)&&(n instanceof Of||n instanceof jf)&&e.firestore===n.firestore&&e.path===n.path&&e.x_===n.x_);var e,n},e.prototype.set=function(t,e){e=$h("DocumentReference.set",e);try{return function(t,e,n){var r=ef(t.firestore,al),i=ql(t.x_,e,n);return bl(r,Cf(Nf(r),"setDoc",t.C_,i,null!==t.x_,n).L_(t.C_,Ro.Ge()))}(this.o_,t,e)}catch(t){throw Nl(t,"setDoc","DocumentReference.set")}},e.prototype.update=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];try{return 1===arguments.length?gl(this.o_,t):gl.apply(void 0,Object(r.h)([this.o_,t,e],n))}catch(t){throw Nl(t,"updateDoc","DocumentReference.update")}},e.prototype.delete=function(){return bl(ef((t=this.o_).firestore,al),[new Jo(t.C_,Ro.Ge())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!_u(r))return r}return{}}(e),o=function(e,n){var r,i,o;return{next:function(e){o.next&&o.next(function(e){return new Al(t.firestore,new fl(t.firestore.o_,t.D_,e.C_,e.N_,e.metadata,t.o_.x_))}(e))},error:null===(r=(o=_u(e[0])?e[0]:_u(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===r?void 0:r.bind(o),complete:null===(i=o.complete)||void 0===i?void 0:i.bind(o)}}(e);return function(t){for(var e,n,i,o=this,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];var a={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||_u(s[c])||(a=s[c],c++);var h,f,l,p={includeMetadataChanges:a.includeMetadataChanges};if(_u(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}if(t instanceof Of)f=ef(t.firestore,al),l=as(t.C_.path),h={next:function(e){s[c]&&s[c](ml(f,t,e))},error:s[c+1],complete:s[c+2]};else{f=ef(t.firestore,al),l=t.M_;var v=new yl(f);h={next:function(e){s[c]&&s[c](new pl(f,v,t,e))},error:s[c+1],complete:s[c+2]},Cl(t.M_)}var y=Il(f),g=new Yh(h),b=new hu(l,g,p);return f.yf.fs((function(){return Object(r.b)(o,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(e){switch(e.label){case 0:return t=ou,[4,il(y)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}}))}))})),function(){g.r_(),f.yf.fs((function(){return Object(r.b)(o,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(e){switch(e.label){case 0:return t=su,[4,il(y)];case 1:return[2,t.apply(void 0,[e.sent(),b])]}}))}))}))}}(this.o_,i,o)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=ef(t.firestore,al),i=Il(n),o=new yl(n),s=new qs;return n.yf.fs((function(){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,el(i)];case 1:return[4,sl(e.sent(),t.C_,s)];case 2:return e.sent(),[2]}}))}))})),s.promise.then((function(e){return new fl(n,o,t.C_,e,new xl(e instanceof rs&&e.Je,!0),t.x_)}))}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=ef(t.firestore,al),i=Il(n),o=new qs;return n.yf.fs((function(){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,il(i)];case 1:return[4,ul(e.sent(),n.yf,t.C_,{source:"server"},o)];case 2:return e.sent(),[2]}}))}))})),o.promise.then((function(e){return ml(n,t,e)}))}(this.o_):function(t){var e=this,n=ef(t.firestore,al),i=Il(n),o=new qs;return n.yf.fs((function(){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,il(i)];case 1:return[4,ul(e.sent(),n.yf,t.C_,{source:"default"},o)];case 2:return e.sent(),[2]}}))}))})),o.promise.then((function(e){return ml(n,t,e)}))}(this.o_)).then((function(t){return new Al(e.firestore,new fl(e.firestore.o_,e.D_,t.C_,t.N_,t.metadata,e.o_.x_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Xh);function Nl(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var xl=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Al=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new jl(this.S_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return vl(this.o_,t.o_)},e}(Xh),Sl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(Al);function kl(t,e,n){if(n instanceof Xh&&(n=n.o_),"string"==typeof n){if(""===n)throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ps(e)&&-1!==n.indexOf("/"))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(kr.k(n));if(!Cr.G(r))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Li(t,new Cr(r))}if(n instanceof Of)return Li(t,n.C_);throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tf(n)+".")}function Dl(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Nr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Pl(t,e,n){if(!n.isEqual(e))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Cl(t){if(hs(t)&&0===t.rn.length)throw new Nr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ll=function(){function t(t,e,n){this.M_=t,this.firestore=e,this.x_=n,this.Lf=Nf(e.o_),this.D_=new mf(e)}return t.prototype.where=function(e,n,r){var i=Bf("Query.where",e),o=function(t,e,n,r,i,o,s){var u;if(i.B()){if("array-contains"===o||"array-contains-any"===o)throw new Nr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Dl(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(kl(r,t,h[c]));u={arrayValue:{values:a}}}else u=kl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Dl(s,o),u=Rf(n,"Query.where",s,"in"===o||"not-in"===o);var f=Os.create(i,o,u);return function(t,e){if(e.cn()){var n=ls(t);if(null!==n&&!n.isEqual(e.field))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=fs(t);null!==r&&Pl(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Nr(jr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.M_,0,this.Lf,this.firestore.v_,i,n,r);return new t(function(t,e){var n=t.filters.concat([e]);return new ss(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(this.M_,o),this.firestore,this.x_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new Nr(jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Bf("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Rs(e,n);return function(t,e){if(null===fs(t)){var n=ls(t);null!==n&&Pl(0,n,e.field)}}(t,r),r}(this.M_,i,r);return new t(function(t,e){var n=t.rn.concat([e]);return new ss(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(this.M_,o),this.firestore,this.x_)},t.prototype.limit=function(e){return nf("Query.limit",e),new t(ys(this.M_,e,"F"),this.firestore,this.x_)},t.prototype.limitToLast=function(e){return nf("Query.limitToLast",e),new t(ys(this.M_,e,"L"),this.firestore,this.x_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.startAt",e,n,!0);return new t(gs(this.M_,i),this.firestore,this.x_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.startAfter",e,n,!1);return new t(gs(this.M_,i),this.firestore,this.x_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.endBefore",e,n,!0);return new t(bs(this.M_,i),this.firestore,this.x_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Bf("Query.endAt",e,n,!1);return new t(bs(this.M_,i),this.firestore,this.x_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&ms(this.M_,e.M_)&&this.x_===e.x_},t.prototype.withConverter=function(e){return new t(this.M_,this.firestore,e)},t.prototype.Bf=function(t,e,n,r){if(e instanceof Al)return function(t,e,n,r,i){if(!r)throw new Nr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=ds(t);s<u.length;s++){var a=u[s];if(a.field.B())o.push(Li(e,r.key));else{var c=r.field(a.field);if(Ei(c))throw new Nr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.M();throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ps(o,i)}(this.M_,this.firestore.v_,t,e.o_.N_,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Nr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.B()){if("string"!=typeof c)throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ps(t)&&-1!==c.indexOf("/"))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(kr.k(c));if(!Cr.G(h))throw new Nr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Cr(h);u.push(Li(e,f))}else{var l=Rf(n,r,c);u.push(l)}}return new Ps(u,o)}(this.M_,this.firestore.v_,this.Lf,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,i=this,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var u={},a=0;if("object"!=typeof o[a]||_u(o[a])||(u=o[a],a++),_u(o[a])){var c=o[a];o[a]=null===(t=c.next)||void 0===t?void 0:t.bind(c),o[a+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),o[a+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}var h={next:function(t){o[a]&&o[a](new Rl(i.firestore,new pl(i.firestore.o_,i.D_,new Tf(i.firestore.o_,i.x_,i.M_),t)))},error:o[a+1],complete:o[a+2]};return Cl(this.M_),function(t,e,n,i){var o=this,s=new Yh(i),u=new hu(e,s,n);return t.rs.fs((function(){return Object(r.b)(o,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:return e=ou,[4,il(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){s.r_(),t.rs.fs((function(){return Object(r.b)(o,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(n){switch(n.label){case 0:return e=su,[4,il(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Il(this.firestore.o_),this.M_,u,h)},t.prototype.get=function(t){var e=this;Cl(this.M_);var n=Il(this.firestore.o_);return(t&&"cache"===t.source?function(t,e){var n=this,i=new qs;return t.rs.fs((function(){return Object(r.b)(n,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(o){switch(o.label){case 0:return n=function(t,e,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,tc(t,e,!0)];case 1:return i=r.sent(),o=new Xc(e,i.Xa),s=o.gh(i.documents),u=o.bi(s,!1),n.resolve(u.snapshot),[3,3];case 2:return a=r.sent(),c=nu(a,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))},[4,el(t)];case 1:return[2,n.apply(void 0,[o.sent(),e,i])]}}))}))})),i.promise}(n,this.M_):function(t,e,n){var i=this;void 0===n&&(n={});var o=new qs;return t.rs.fs((function(){return Object(r.b)(i,void 0,void 0,(function(){var i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return i=function(t,e,n,r,i){var o=new Yh({next:function(n){e.fs((function(){return su(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Nr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new hu(n,o,{includeMetadataChanges:!0,Hs:!0});return ou(t,s)},[4,il(t)];case 1:return[2,i.apply(void 0,[r.sent(),t.rs,e,n,o])]}}))}))})),o.promise}(n,this.M_,t)).then((function(t){return new Rl(e.firestore,new pl(e.firestore.o_,e.D_,new Tf(e.firestore.o_,e.x_,e.M_),t))}))},t}(),Vl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Sl(this.S_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),e}(Xh),Rl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).S_=e,r}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ll(this.o_.query.M_,this.S_,this.o_.query.x_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map((function(e){return new Sl(t.S_,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map((function(t){return new Vl(e.S_,t)}))},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach((function(r){t.call(e,new Sl(n.S_,r))}))},e.prototype.isEqual=function(t){return vl(this.o_,t.o_)},e}(Xh),Ml=function(t){function e(e,n,r){var i=this;if((i=t.call(this,as(e),n,r)||this).O_=e,e.length%2!=1)throw new Nr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.M()+" has "+e.length);return i}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.M_.path.C()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.M_.path.S();return t.T()?null:jl.xf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.M_.path.M()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){0===arguments.length&&(t=br.u()),Jh("CollectionReference.doc","path",t);var e=kr.k(t);return jl.xf(this.M_.path.child(e),this.firestore,this.x_)},e.prototype.add=function(t){var e=this.x_?this.x_.toFirestore(t):t,n=this.doc();return jl.b_(n.o_.C_,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.O_,this.firestore,t)},e}(Ll);function Ul(t,e,n){var r=ef(e,Of);if(r.firestore!==n.o_)throw new Nr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function ql(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Fl=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Ef.bind.apply(Ef,Object(r.h)([void 0],e))))||this}return Object(r.d)(e,t),e.documentId=function(){return new e(Pr.q().M())},e.prototype.isEqual=function(t){return t instanceof Xh&&(t=t.o_),t instanceof Ef&&this.o_.F_.isEqual(t.F_)},e}(Xh),Bl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.serverTimestamp=function(){var t=new uf("serverTimestamp");return t.a_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new of("deleteField");return t.a_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new af("arrayUnion",t)}).apply(void 0,t);return r.a_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cf("arrayRemove",t)}).apply(void 0,t);return r.a_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new hf("increment",t)}(t);return n.a_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(Xh),Gl={Firestore:_l,GeoPoint:ff,Timestamp:xr,Blob:gf,Transaction:Ol,WriteBatch:Tl,DocumentReference:jl,DocumentSnapshot:Al,Query:Ll,QueryDocumentSnapshot:Sl,QuerySnapshot:Rl,CollectionReference:Ml,FieldPath:Fl,FieldValue:Bl,setLogLevel:function(t){ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function zl(t){!function(t,e){t.INTERNAL.registerComponent(new or.a("firestore",(function(t){return function(t,e){return new _l(t,new al(t,e),new wl)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Gl)))}(t),t.registerVersion("@firebase/firestore","2.0.2")}zl(i.a)}}]);